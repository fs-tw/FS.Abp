{"version":3,"file":"page-bar.component.js","sourceRoot":"../../../../../libs/theme-alain-ms/layout/src/","sources":["lib/ms/shared/page-bar/page-bar.component.ts"],"names":[],"mappings":";AAAA,OAAO,EAAiB,uBAAuB,EAAE,iBAAiB,EAAE,SAAS,EAAE,KAAK,EAA0B,MAAM,eAAe,CAAC;AACpI,OAAO,EAAE,aAAa,EAAE,MAAM,EAAE,MAAM,iBAAiB,CAAC;AACxD,OAAO,EAAE,KAAK,EAAgB,MAAM,MAAM,CAAC;AAC3C,OAAO,EAAE,MAAM,EAAE,MAAM,gBAAgB,CAAC;AAExC,OAAO,EAAQ,WAAW,EAAE,MAAM,cAAc,CAAC;AACjD,OAAO,EAAE,YAAY,EAAE,MAAM,aAAa,CAAC;AAE3C,OAAO,EAAE,YAAY,EAAE,MAAM,kBAAkB,CAAC;AAUhD,MAAM,OAAO,kBAAkB;IAsB7B,aAAa;IAEb,YAAoB,MAAc,EAAU,GAAiB,EAAU,OAAoB,EAAU,GAAsB;QAAvG,WAAM,GAAN,MAAM,CAAQ;QAAU,QAAG,GAAH,GAAG,CAAc;QAAU,YAAO,GAAP,OAAO,CAAa;QAAU,QAAG,GAAH,GAAG,CAAmB;QAtBnH,WAAM,GAAkB,IAAI,CAAC;QAUrC,iBAAiB;QAEjB;;WAEG;QACsB,cAAS,GAAG,IAAI,CAAC;QACjB,wBAAmB,GAAG,IAAI,CAAC;IAM0E,CAAC;IArB/H,IAAY,KAAK;QACf,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,OAAO,IAAI,CAAC,MAAM,CAAC;SACpB;QACD,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,IAAI,CAAC,mBAAmB,CAAC,CAAC;QAEjG,OAAO,IAAI,CAAC,MAAM,CAAC;IACrB,CAAC;IAgBO,QAAQ;QACd,IAAI,OAAO,IAAI,CAAC,KAAK,KAAK,WAAW,IAAI,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;YAChF,MAAM,IAAI,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAC/C,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC;SACxB;QAED,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;IAC3B,CAAC;IAED,eAAe;QACb,IAAI,CAAC,OAAO,GAAG,KAAK,CAClB,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,YAAY,aAAa,CAAC,CAAC,EAClE,IAAI,CAAC,GAAG,CAAC,MAAM,EACf,IAAI,CAAC,OAAO,CAAC,MAAM,CACpB,CAAC,SAAS,CAAC,GAAG,EAAE;YACf,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,QAAQ,EAAE,CAAC;QAClB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,WAAW;QACT,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;IAC7B,CAAC;;;YAxDF,SAAS,SAAC;gBACT,QAAQ,EAAE,UAAU;gBACpB,wcAAwC;gBACxC,IAAI,EAAE;oBACJ,qBAAqB,EAAE,MAAM;iBAC9B;gBACD,eAAe,EAAE,uBAAuB,CAAC,MAAM;aAChD;;;YAhBuB,MAAM;YAOrB,YAAY;YAHN,WAAW;YALuB,iBAAiB;;;wBAmC/D,KAAK;kCACL,KAAK;oBACL,KAAK;uBACL,KAAK;;AAHmB;IAAf,YAAY,EAAE;;qDAAkB;AACjB;IAAf,YAAY,EAAE;;+DAA4B","sourcesContent":["import { AfterViewInit, ChangeDetectionStrategy, ChangeDetectorRef, Component, Input, OnDestroy, TemplateRef } from '@angular/core';\r\nimport { NavigationEnd, Router } from '@angular/router';\r\nimport { merge, Subscription } from 'rxjs';\r\nimport { filter } from 'rxjs/operators';\r\n\r\nimport { Menu, MenuService } from '@delon/theme';\r\nimport { InputBoolean } from '@delon/util';\r\n\r\nimport { BrandService } from '../../ms.service';\r\n\r\n@Component({\r\n  selector: 'page-bar',\r\n  templateUrl: './page-bar.component.html',\r\n  host: {\r\n    '[class.ms-page-bar]': 'true',\r\n  },\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class MSPageBarComponent implements AfterViewInit, OnDestroy {\r\n  private router$!: Subscription;\r\n  private _menus: Menu[] | null = null;\r\n  private get menus(): Menu[] {\r\n    if (this._menus) {\r\n      return this._menus;\r\n    }\r\n    this._menus = this.menuSrv.getPathByUrl(this.router.url.split('?')[0], this.recursiveBreadcrumb);\r\n\r\n    return this._menus;\r\n  }\r\n\r\n  // #region fields\r\n\r\n  /**\r\n   * 自动生成标题，以当前路由从主菜单中定位\r\n   */\r\n  @Input() @InputBoolean() autoTitle = true;\r\n  @Input() @InputBoolean() recursiveBreadcrumb = true;\r\n  @Input() title?: string | TemplateRef<any>;\r\n  @Input() subTitle?: string | TemplateRef<any>;\r\n\r\n  // #endregion\r\n\r\n  constructor(private router: Router, private srv: BrandService, private menuSrv: MenuService, private cdr: ChangeDetectorRef) {}\r\n\r\n  private setTitle(): void {\r\n    if (typeof this.title === 'undefined' && this.autoTitle && this.menus.length > 0) {\r\n      const item = this.menus[this.menus.length - 1];\r\n      this.title = item.text;\r\n    }\r\n\r\n    this.cdr.detectChanges();\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.router$ = merge(\r\n      this.router.events.pipe(filter((e) => e instanceof NavigationEnd)),\r\n      this.srv.notify,\r\n      this.menuSrv.change,\r\n    ).subscribe(() => {\r\n      this._menus = null;\r\n      this.setTitle();\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.router$.unsubscribe();\r\n  }\r\n}\r\n"]}