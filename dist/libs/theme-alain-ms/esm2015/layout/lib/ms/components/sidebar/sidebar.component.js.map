{"version":3,"file":"sidebar.component.js","sourceRoot":"../../../../../libs/theme-alain-ms/layout/src/","sources":["lib/ms/components/sidebar/sidebar.component.ts"],"names":[],"mappings":"AACA,OAAO,EAEL,uBAAuB,EACvB,iBAAiB,EACjB,SAAS,EACT,UAAU,EAEV,SAAS,GACV,MAAM,eAAe,CAAC;AAKvB,OAAO,EAAE,kBAAkB,EAAE,MAAM,wCAAwC,CAAC;AAC5E,OAAO,EAAE,YAAY,EAAE,MAAM,kBAAkB,CAAC;AAChD,OAAO,EAAE,gBAAgB,EAAE,MAAM,gCAAgC,CAAC;AAWlE,MAAM,OAAO,kBAAkB;IAmB7B,YACU,kBAAqC,EACrC,KAAmB,EACnB,GAAqB,EACrB,GAAsB;QAHtB,uBAAkB,GAAlB,kBAAkB,CAAmB;QACrC,UAAK,GAAL,KAAK,CAAc;QACnB,QAAG,GAAH,GAAG,CAAkB;QACrB,QAAG,GAAH,GAAG,CAAmB;QAnBhC,gBAAW,GAAG,KAAK,CAAC;QACpB,WAAM,GAAG,KAAK,CAAC;QAUf,MAAC,GAAG,EAAE,CAAC;QAEP,qBAAgB,GAAwB,EAAE,CAAC;QAQzC,KAAK,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;IACzB,CAAC;IAnBD,IAAI,UAAU;QACZ,OAAO,IAAI,CAAC,kBAAkB,CAAC,aAAa,EAAE,CAAC;IACjD,CAAC;IAED,IAAI,CAAC;QACH,OAAO,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC;IACvB,CAAC;IAeD,MAAM,CAAC,SAAkB,IAAI;QAC3B,MAAM,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACpC,IAAI,CAAC,UAAU,GAAG,GAAG,CAAC,IAAI,CAAC;QAC3B,IAAI,CAAC,gBAAgB,GAAG,GAAG,CAAC,UAAU,CAAC;QAEvC,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;QAEzB,IAAI,MAAM,EAAE;YACV,sBAAsB;YACtB,UAAU,CAAC,GAAG,EAAE;gBACd,QAAQ;gBACR,IAAI,CAAC,UAAU,CAAC,aAAa,CAAC,SAAS,GAAG,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;SACJ;IACH,CAAC;IAED,eAAe;QACb,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE;YACjC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;YACnB,IAAI,CAAC,MAAM,EAAE,CAAC;QAChB,CAAC,CAAC,CAAC;IACL,CAAC;IAED,WAAW;QACT,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;IAC/B,CAAC;;;YA9DF,SAAS,SAAC;gBACT,QAAQ,EAAE,YAAY;gBACtB,82EAAuC;gBACvC,IAAI,EAAE;oBACJ,2BAA2B,EAAE,MAAM;oBACnC,uCAAuC,EAAE,aAAa;iBACvD;gBACD,eAAe,EAAE,uBAAuB,CAAC,MAAM;aAChD;;;YAZQ,kBAAkB;YAClB,YAAY;YACZ,gBAAgB;YAZvB,iBAAiB;;;yBAwBhB,SAAS,SAAC,YAAY,EAAE,EAAE,MAAM,EAAE,KAAK,EAAE","sourcesContent":["import { CdkDragDrop, moveItemInArray } from '@angular/cdk/drag-drop';\r\nimport {\r\n  AfterViewInit,\r\n  ChangeDetectionStrategy,\r\n  ChangeDetectorRef,\r\n  Component,\r\n  ElementRef,\r\n  OnDestroy,\r\n  ViewChild,\r\n} from '@angular/core';\r\nimport { _HttpClient } from '@delon/theme';\r\nimport { NzMessageService } from 'ng-zorro-antd/message';\r\nimport { Observable } from 'rxjs';\r\nimport { MSProduct, MSProductCategory, MSProductI18n } from '../../../models';\r\nimport { LayoutStateService } from '../../../services/layout-state.service';\r\nimport { BrandService } from '../../ms.service';\r\nimport { MSProductService } from '../../services/product.service';\r\n\r\n@Component({\r\n  selector: 'ms-sidebar',\r\n  templateUrl: './sidebar.component.html',\r\n  host: {\r\n    '[class.alain-ms__sidebar]': 'true',\r\n    '[class.alain-ms__sidebar-showproduct]': 'showProduct',\r\n  },\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class MSSidebarComponent implements AfterViewInit, OnDestroy {\r\n  @ViewChild('categoryEl', { static: false })\r\n  private categoryEl!: ElementRef;\r\n\r\n  showProduct = false;\r\n  inited = false;\r\n\r\n  get shortcuts$(): Observable<MSProduct[]> {\r\n    return this.layoutStateService.getShortcuts$();\r\n  }\r\n\r\n  get l(): MSProductI18n {\r\n    return this.srv.i18n;\r\n  }\r\n\r\n  q = '';\r\n  searchList?: MSProductCategory[][];\r\n  searchCategories: MSProductCategory[] = [];\r\n\r\n  constructor(\r\n    private layoutStateService:LayoutStateService,\r\n    private brand: BrandService,\r\n    private srv: MSProductService,\r\n    private cdr: ChangeDetectorRef\r\n  ) {\r\n    brand.setSidebar(true);\r\n  }\r\n\r\n  search(scroll: boolean = true): void {\r\n    const res = this.srv.search(this.q);\r\n    this.searchList = res.list;\r\n    this.searchCategories = res.categories;\r\n\r\n    this.cdr.detectChanges();\r\n\r\n    if (scroll) {\r\n      // wait angular render\r\n      setTimeout(() => {\r\n        // 滚动至顶部\r\n        this.categoryEl.nativeElement.scrollTop = 0;\r\n      });\r\n    }\r\n  }\r\n\r\n  ngAfterViewInit(): void {\r\n    this.srv.getData().subscribe((x) => {\r\n      this.inited = true;\r\n      this.search();\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.brand.setSidebar(false);\r\n  }\r\n}\r\n"]}