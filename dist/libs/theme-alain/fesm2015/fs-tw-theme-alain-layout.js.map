{"version":3,"file":"fs-tw-theme-alain-layout.js","sources":["../../libs/theme-alain/layout/src/lib/basic/basic.component.ts","../libs/theme-alain/layout/src/lib/basic/widgets/fullscreen.component.ts","../libs/theme-alain/layout/src/lib/basic/widgets/i18n.component.ts","../libs/theme-alain/layout/src/lib/basic/widgets/user.component.ts","../../libs/theme-alain/layout/src/lib/blank/blank.component.ts","../../libs/theme-alain/layout/src/lib/passport/passport.component.ts","../../libs/theme-alain/layout/src/lib/providers/menu.provider.ts","../layout/src/lib/layout.module.ts","../../../../libs/theme-alain/layout/src/fs-tw-theme-alain-layout.ts"],"sourcesContent":["import { Component, TrackByFunction } from '@angular/core';\r\nimport { LayoutDefaultOptions } from '@delon/theme/layout-default';\r\nimport { ABP } from '@abp/ng.core'\r\nimport { NavItemsService, NavItem as AbpNavItem } from '@abp/ng.theme.shared';\r\nimport { map } from 'rxjs/operators';\r\n\r\n@Component({\r\n  selector: 'layout-basic',\r\n  templateUrl: 'basic.component.html',\r\n})\r\nexport class LayoutBasicComponent {\r\n  trackByFn: TrackByFunction<NavItem> = (_, element) => element?.id;\r\n  options: LayoutDefaultOptions = {\r\n    logoExpanded: `./assets/logo-full.svg`,\r\n    logoCollapsed: `./assets/logo.svg`,\r\n  };\r\n\r\n  navItems$ = this.navItems.items$.pipe(map(x => x.map(y => y as NavItem)));\r\n\r\n\r\n  constructor(public readonly navItems: NavItemsService) {\r\n  }\r\n\r\n}\r\nexport interface NavItem extends AbpNavItem {\r\n  data: ABP.Dictionary<string>\r\n}","import { ChangeDetectionStrategy, Component, HostListener } from '@angular/core';\r\nimport * as screenfull from 'screenfull';\r\n\r\n@Component({\r\n  selector: 'header-fullscreen',\r\n  template: `\r\n  <div layout-default-header-item-trigger nzPlacement=\"bottomRight\">\r\n    <i nz-icon [nzType]=\"status ? 'fullscreen-exit' : 'fullscreen'\"></i>\r\n  </div>\r\n  `,\r\n  // tslint:disable-next-line: no-host-metadata-property\r\n  host: {\r\n    '[class.d-block]': 'true',\r\n  },\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class HeaderFullScreenComponent {\r\n  status = false;\r\n  private get sf(): screenfull.Screenfull {\r\n    return screenfull as screenfull.Screenfull;\r\n  }\r\n\r\n  @HostListener('window:resize')\r\n  _resize(): void {\r\n    this.status = this.sf.isFullscreen;\r\n  }\r\n\r\n  @HostListener('click')\r\n  _click(): void {\r\n    if (this.sf.isEnabled) {\r\n      this.sf.toggle();\r\n    }\r\n  }\r\n}\r\n","import { ConfigStateService, SessionStateService, ApplicationConfiguration } from '@abp/ng.core';\r\nimport { ChangeDetectionStrategy, Component, Input } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { map } from 'rxjs/operators';\r\nimport { BooleanInput, InputBoolean } from '@delon/util';\r\nimport snq from 'snq';\r\n\r\n\r\n@Component({\r\n  selector: 'header-i18n',\r\n  templateUrl: 'i18n.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class HeaderI18nComponent {\r\n  static ngAcceptInputType_showLangText: BooleanInput;\r\n  @Input() @InputBoolean() showLangText = true;\r\n\r\n  languages$ = this.configState.getDeep$('localization.languages');\r\n\r\n  get defaultLanguage$(): Observable<{ displayName: string; flagIcon: string }> {\r\n    return this.languages$.pipe(\r\n      map(languages => {\r\n        const lang: Partial<ApplicationConfiguration.Language> = snq(\r\n          () => languages.find(language => language.cultureName === this.selectedLangCulture),\r\n          {} as Partial<ApplicationConfiguration.Language>,\r\n        );\r\n        return {\r\n          displayName: lang.displayName || '',\r\n          flagIcon: lang.flagIcon,\r\n        };\r\n      }),\r\n    );\r\n  }\r\n\r\n  get dropdownLanguages$(): Observable<ApplicationConfiguration.Language[]> {\r\n    return this.languages$.pipe(\r\n      map(\r\n        languages =>\r\n          snq(() => languages.filter(lang => lang.cultureName !== this.selectedLangCulture)),\r\n        [],\r\n      ),\r\n    );\r\n  }\r\n\r\n  get selectedLangCulture(): string {\r\n    return this.sessionState.getLanguage();\r\n  }\r\n\r\n  constructor(\r\n    private configState: ConfigStateService,\r\n    private sessionState: SessionStateService\r\n  ) { }\r\n\r\n  change(cultureName: string): void {\r\n    this.sessionState.setLanguage(cultureName);\r\n  }\r\n}\r\n","import { ChangeDetectionStrategy, Component } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { ConfigStateService,CurrentUserDto } from '@abp/ng.core';\r\nimport { AuthService } from '@fs-tw/account';\r\nimport { Observable } from 'rxjs';\r\n\r\n@Component({\r\n  selector: 'header-user',\r\n  templateUrl: 'user.component.html',\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class HeaderUserComponent {\r\n  currentUser$: Observable<CurrentUserDto> = this.configStateService.getOne$('currentUser');\r\n\r\n  constructor(\r\n    private authService: AuthService,\r\n    private router: Router,\r\n    private configStateService: ConfigStateService\r\n  ) { }\r\n\r\n  initLogin() {\r\n    this.authService.initLogin();\r\n  }\r\n\r\n  logout() {\r\n    this.authService.logout().subscribe(() => {\r\n      this.router.navigate(['/'], { state: { redirectUrl: this.router.url } });\r\n    });\r\n  }\r\n}\r\n","import { Component } from '@angular/core';\r\n\r\n@Component({\r\n  selector: 'layout-blank',\r\n  template: `<router-outlet></router-outlet> `,\r\n  // tslint:disable-next-line: no-host-metadata-property\r\n  host: {\r\n    '[class.alain-blank]': 'true',\r\n  },\r\n})\r\nexport class LayoutBlankComponent {}\r\n","import { Component, Inject, OnInit } from '@angular/core';\r\nimport { DA_SERVICE_TOKEN, ITokenService } from '@delon/auth';\r\n\r\n@Component({\r\n  selector: 'layout-passport',\r\n  templateUrl: './passport.component.html',\r\n  styleUrls: ['./passport.component.less'],\r\n})\r\nexport class LayoutPassportComponent implements OnInit {\r\n  links = [\r\n    {\r\n      title: '帮助',\r\n      href: '',\r\n    },\r\n    {\r\n      title: '隐私',\r\n      href: '',\r\n    },\r\n    {\r\n      title: '条款',\r\n      href: '',\r\n    },\r\n  ];\r\n\r\n  constructor(@Inject(DA_SERVICE_TOKEN) private tokenService: ITokenService) {}\r\n\r\n  ngOnInit(): void {\r\n    this.tokenService.clear();\r\n  }\r\n}\r\n","import { Injector } from '@angular/core';\r\nimport { RoutesService, ABP, TreeNode, LocalizationPipe, PermissionService } from '@abp/ng.core';\r\nimport { APP_INITIALIZER } from '@angular/core';\r\nimport { MenuService, Menu, SettingsService } from '@delon/theme';\r\n\r\nexport const LAYOUT_MENU_PROVIDERS = [\r\n  {\r\n    provide: APP_INITIALIZER,\r\n    useFactory: configureMenus,\r\n    deps: [Injector],\r\n    multi: true,\r\n  },\r\n];\r\n\r\nexport function configureMenus(injector: Injector) {\r\n  return () => {\r\n    const menuService: MenuService = injector.get(MenuService);\r\n    const routes: RoutesService = injector.get(RoutesService);\r\n    const localizationPipe: LocalizationPipe = injector.get(LocalizationPipe);\r\n    const permissionService: PermissionService = injector.get(PermissionService);\r\n    const settingsService: SettingsService = injector.get(SettingsService);\r\n\r\n    routes.visible$.subscribe(x => {\r\n      menuService.clear();\r\n      let condition = x => x.name == 'AbpUiNavigation::Menu:Administration' && isGrantedPolicy(x.requiredPolicy);\r\n      let menus = x.filter(condition).map(r => {\r\n        return mapToMenu(r);\r\n      });\r\n      menuService.add(menus);\r\n    })\r\n\r\n    settingsService.notify.subscribe(x => {\r\n      setTimeout(() => { window.dispatchEvent(new Event('resize')); }, 0)\r\n    });\r\n\r\n\r\n    function mapToMenu(item: TreeNode<ABP.Route>) {\r\n      const menu: Menu = {\r\n        text: localizationPipe.transform(item.name),\r\n        link: item.path,\r\n        icon: item.iconClass,\r\n        children: []\r\n      }\r\n      if (item.children.filter(x => isGrantedPolicy(x.requiredPolicy)).length > 0) {\r\n        menu.children = item.children.map(x => mapToMenu(x));\r\n      }\r\n      return menu;\r\n\r\n    }\r\n    function isGrantedPolicy(requiredPolicy: string) {\r\n      if (!!requiredPolicy) {\r\n        return permissionService.getGrantedPolicy(requiredPolicy);\r\n      }\r\n      return true;\r\n    }\r\n\r\n\r\n  };\r\n}","import { CoreModule } from '@abp/ng.core';\r\nimport { ModuleWithProviders, NgModule } from '@angular/core';\r\nimport { FormsModule } from '@angular/forms';\r\nimport { RouterModule } from '@angular/router';\r\nimport { LayoutDefaultModule } from '@delon/theme/layout-default';\r\nimport { NzDropDownModule } from 'ng-zorro-antd/dropdown';\r\nimport { NzIconModule } from 'ng-zorro-antd/icon';\r\n\r\nimport { LayoutBasicComponent } from './basic/basic.component';\r\nimport { HeaderFullScreenComponent } from './basic/widgets/fullscreen.component';\r\nimport { HeaderI18nComponent } from './basic/widgets/i18n.component';\r\nimport { HeaderUserComponent } from './basic/widgets/user.component';\r\nimport { LayoutBlankComponent } from './blank/blank.component';\r\nimport { LayoutPassportComponent } from './passport/passport.component';\r\nimport { LAYOUT_MENU_PROVIDERS } from './providers/menu.provider';\r\n\r\nconst LAYOUTCOMPONENTS = [LayoutBasicComponent, LayoutBlankComponent, LayoutPassportComponent];\r\n\r\nconst HEADERCOMPONENTS = [\r\n  HeaderI18nComponent,\r\n  HeaderUserComponent,\r\n  HeaderFullScreenComponent\r\n];\r\n@NgModule({\r\n  imports: [\r\n    CoreModule,\r\n    FormsModule,\r\n    RouterModule,\r\n    LayoutDefaultModule,\r\n    NzDropDownModule,\r\n    NzIconModule\r\n  ],\r\n  declarations: [...LAYOUTCOMPONENTS, ...HEADERCOMPONENTS],\r\n  exports: [...LAYOUTCOMPONENTS, ...HEADERCOMPONENTS],\r\n})\r\nexport class LayoutModule {\r\n  static forRoot(): ModuleWithProviders<LayoutModule> {\r\n    return {\r\n      ngModule: LayoutModule,\r\n      providers: [\r\n        LAYOUT_MENU_PROVIDERS\r\n      ]\r\n    };\r\n  }\r\n}\r\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n\nexport {LAYOUT_MENU_PROVIDERS as ɵa,configureMenus as ɵb} from './lib/providers/menu.provider';"],"names":[],"mappings":"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"}