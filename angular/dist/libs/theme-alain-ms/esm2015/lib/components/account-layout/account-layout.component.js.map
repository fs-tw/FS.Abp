{"version":3,"file":"account-layout.component.js","sourceRoot":"","sources":["../../../../../../../libs/theme-alain-ms/src/lib/components/account-layout/account-layout.component.ts","../../../../../../../libs/theme-alain-ms/src/lib/components/account-layout/account-layout.component.html"],"names":[],"mappings":"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","sourcesContent":["import { DOCUMENT } from '@angular/common';\r\nimport {\r\n  Component,\r\n  ElementRef,\r\n  Inject,\r\n  OnDestroy,\r\n  OnInit,\r\n  Renderer2,\r\n} from '@angular/core';\r\nimport {\r\n  ActivatedRoute,\r\n  NavigationEnd,\r\n  NavigationError,\r\n  RouteConfigLoadStart,\r\n  Router,\r\n} from '@angular/router';\r\nimport { BreakpointObserver, MediaMatcher } from '@angular/cdk/layout';\r\nimport {\r\n  LayoutStateService,\r\n  MSMenu,\r\n  MSServiceNavConfig,\r\n} from '@fs-tw/theme-alain-ms/layout';\r\nimport { ReuseTabService } from '@delon/abc/reuse-tab';\r\nimport { updateHostClass } from '@delon/util';\r\nimport { NzMessageService } from 'ng-zorro-antd/message';\r\nimport { Observable, Subscription } from 'rxjs';\r\nimport { BrandService } from '@fs-tw/theme-alain-ms/layout';\r\nimport { Layout } from '@fs-tw/theme-alain-ms/layout';\r\n\r\n@Component({\r\n  selector: 'abp-account-layout',\r\n  templateUrl: './account-layout.component.html',\r\n  styleUrls: ['./account-layout.component.less'],\r\n})\r\nexport class AccountLayoutComponent implements OnInit, OnDestroy {\r\n  private notify$!: Subscription;\r\n  private queryCls?: string;\r\n  //nav = false;\r\n  \r\n\r\n  store$: Observable<Layout.State>;\r\n\r\n  //hasAllNav = false;\r\n  //hasSidebar = true;\r\n  isFetching = false;\r\n\r\n  get isMobile(): boolean {\r\n    return this.srv.isMobile;\r\n  }\r\n\r\n  private get body(): HTMLElement {\r\n    return this.doc.body;\r\n  }\r\n\r\n  get isCurrentPath() {\r\n    return this.router.createUrlTree(['./'], { relativeTo: this.route }).toString() === this.router.routerState.snapshot.url.toString();\r\n  }\r\n\r\n  get parentPath() {\r\n    var parentPath = this.layoutStateService?.routesProcessor?.CurrentRoute?.parent?.path ?? \"/\";\r\n    var parentPathLength = parentPath.split(\"/\").length;\r\n\r\n    var url = this.layoutStateService?.routesProcessor?.CurrentUrl ?? \"/\";\r\n    var urlArray = url.split(\"/\").filter((x, i) => i < parentPathLength);\r\n    \r\n    return urlArray.toString().replace(/,/g, \"/\");\r\n  }\r\n\r\n  constructor(\r\n    public layoutStateService: LayoutStateService,\r\n    bm: BreakpointObserver,\r\n    mediaMatcher: MediaMatcher,\r\n    private router: Router,\r\n    private route: ActivatedRoute,\r\n    public msg: NzMessageService,\r\n    reuseTabSrv: ReuseTabService,\r\n    private el: ElementRef,\r\n    private renderer: Renderer2,\r\n    private srv: BrandService,\r\n    @Inject(DOCUMENT) private doc: any\r\n  ) {\r\n    this.store$ = this.layoutStateService.getStore$();\r\n    const routerData = {\r\n      hasAllNav: false,\r\n      hasSidebar: true,\r\n      ...route.snapshot.data,\r\n    };\r\n    //this.hasAllNav = routerData.hasAllNav === true;\r\n    //this.hasSidebar = routerData.hasSidebar === true;\r\n\r\n    // scroll to top in change page\r\n    router.events.subscribe((evt) => {\r\n      if (!this.isFetching && evt instanceof RouteConfigLoadStart) {\r\n        this.isFetching = true;\r\n        this.scrollToTop();\r\n      }\r\n      if (evt instanceof NavigationError) {\r\n        this.isFetching = false;\r\n        msg.error(`无法加载${evt.url}路由`, { nzDuration: 1000 * 3 });\r\n        return;\r\n      }\r\n      if (!(evt instanceof NavigationEnd)) {\r\n        return;\r\n      }\r\n\r\n      this.isFetching = false;\r\n      // If have already cached router, should be don't need scroll to top\r\n      if (reuseTabSrv.exists(evt.url)) {\r\n        return;\r\n      }\r\n\r\n      this.scrollToTop();\r\n    });\r\n\r\n    // media\r\n    const query: { [key: string]: string } = {\r\n      'screen-xs': '(max-width: 575px)',\r\n      'screen-sm': '(min-width: 576px) and (max-width: 767px)',\r\n      'screen-md': '(min-width: 768px) and (max-width: 991px)',\r\n      'screen-lg': '(min-width: 992px) and (max-width: 1199px)',\r\n      'screen-xl': '(min-width: 1200px)',\r\n    };\r\n    bm.observe([\r\n      '(min-width: 1200px)',\r\n      '(min-width: 992px) and (max-width: 1199px)',\r\n      '(min-width: 768px) and (max-width: 991px)',\r\n      '(min-width: 576px) and (max-width: 767px)',\r\n      '(max-width: 575px)',\r\n    ]).subscribe(() => {\r\n      this.queryCls = Object.keys(query).find(\r\n        (key) => mediaMatcher.matchMedia(query[key]).matches\r\n      );\r\n      this.setClass();\r\n    });\r\n  }\r\n\r\n  private scrollToTop(): void {\r\n    const el: HTMLElement = this.doc.querySelector('.alain-ms__product-body');\r\n    if (!el) {\r\n      return;\r\n    }\r\n    el.scrollTop = 0;\r\n  }\r\n\r\n  private setClass(): void {\r\n    const { el, renderer, queryCls } = this;\r\n    updateHostClass(\r\n      el.nativeElement,\r\n      renderer,\r\n      {\r\n        ['alain-ms']: true,\r\n        [queryCls!]: true,\r\n      },\r\n      true\r\n    );\r\n  }\r\n\r\n  private setBodyClass(): void {\r\n    const { hasTopbar, hasSidebar, hasFixed, colorWeak } = this.srv.layout;\r\n    updateHostClass(this.body, this.renderer, {\r\n      'color-weak': colorWeak,\r\n      ['alain-ms__has-topbar']: hasTopbar,\r\n      ['alain-ms__has-sidebar']: hasSidebar,\r\n      ['alain-ms__has-fixed']: hasFixed,\r\n    });\r\n  }\r\n\r\n  ngOnInit(): void {\r\n    this.notify$ = this.srv.notify.subscribe(() => {\r\n      this.setClass();\r\n      this.setBodyClass();\r\n    });\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.notify$.unsubscribe();\r\n    this.body.classList.remove(\r\n      'alain-ms__has-topbar',\r\n      'alain-ms__has-sidebar',\r\n      'alain-ms__has-fixed'\r\n    );\r\n  }\r\n}\r\n","<ng-container *ngIf=\"store$ | async as store\">\r\n  <ms-topbar></ms-topbar>\r\n  <!-- <ms-sidebar *ngIf=\"store.sidebarConfig.hasSidebar\"></ms-sidebar> -->\r\n  <div class=\"brand-page-loading\" [hidden]=\"!store.isFetching\">\r\n    <nz-spin nzSpinning></nz-spin>\r\n  </div>\r\n  <div class=\"alain-ms__body\" [hidden]=\"store.isFetching\">\r\n    <service-layout [hasConsoleCss]=\"false\">\r\n      \r\n      <router-outlet></router-outlet>\r\n      \r\n    </service-layout>\r\n    </div>\r\n  \r\n\r\n\r\n\r\n</ng-container>\r\n"]}