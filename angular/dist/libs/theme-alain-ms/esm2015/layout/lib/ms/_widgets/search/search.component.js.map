{"version":3,"file":"search.component.js","sourceRoot":"","sources":["../../../../../../../../../libs/theme-alain-ms/layout/src/lib/ms/_widgets/search/search.component.ts","../../../../../../../../../libs/theme-alain-ms/layout/src/lib/ms/_widgets/search/search.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,uBAAuB,EAAE,iBAAiB,EAAE,SAAS,EAAE,UAAU,EAAE,YAAY,EAAa,SAAS,EAAE,MAAM,eAAe,CAAC;AACtI,OAAO,EAAE,WAAW,EAAE,MAAM,cAAc,CAAC;AAC3C,OAAO,EAAE,OAAO,EAAE,MAAM,MAAM,CAAC;AAC/B,OAAO,EAAE,YAAY,EAAE,oBAAoB,EAAE,SAAS,EAAE,MAAM,gBAAgB,CAAC;AAC/E,OAAO,EAAmB,eAAe,EAAE,MAAM,+BAA+B,CAAC;;;;;;;;;;;ICU7E,yCAA2D;IACzD,YACF;IAAA,iBAAiB;;;IAFyB,iCAAgB;IACxD,eACF;IADE,wCACF;;;ADDJ,MAAM,OAAO,iBAAiB;IAW5B,YAAY,IAAiB,EAAU,GAAoB,EAAU,GAAsB;QAApD,QAAG,GAAH,GAAG,CAAiB;QAAU,QAAG,GAAH,GAAG,CAAmB;QAT3F,SAAI,GAAG,KAAK,CAAC;QACb,MAAC,GAAG,EAAE,CAAC;QACP,YAAO,GAAG,IAAI,OAAO,EAAU,CAAC;QAChC,SAAI,GAAU,EAAE,CAAC;QAOf,IAAI,CAAC,OAAO;aACT,IAAI,CACH,YAAY,CAAC,GAAG,CAAC,EACjB,oBAAoB,EAAE,EACtB,SAAS,CAAC,CAAC,CAAS,EAAE,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,CACrE;aACA,SAAS,CAAC,CAAC,GAAQ,EAAE,EAAE;YACtB,IAAI,CAAC,IAAI,GAAG,GAAG,CAAC,IAAI,CAAC;YACrB,IAAI,CAAC,GAAG,CAAC,aAAa,EAAE,CAAC;QAC3B,CAAC,CAAC,CAAC;IACP,CAAC;IAfD,IAAI,CAAC;QACH,OAAO,IAAI,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;IACnC,CAAC;IAgBD,MAAM;QACJ,IAAI,CAAC,GAAG,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;QAC/B,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACnB,CAAC;IAED,WAAW;QACT,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;IAC7B,CAAC;;kFAhCU,iBAAiB;sDAAjB,iBAAiB;;;;;;8FAAjB,YAAQ;;;;QCfrB,8BAA8E;QAC5E,mCASE;QAJA,qIAAe,sFACN,oEAAkC,IAD5B,yFAGA,KAAK,IAHL;QALjB,iBASE;QACF,uBAA6D;QAC7D,uBAAwC;QACxC,6CAA+C;QAC7C,wFAEiB;QACnB,iBAAkB;QACpB,iBAAM;;;QAlBwB,8DAA+C;QAIzE,eAAiC;QAAjC,0DAAiC;QAEjC,+BAAe,uBAAA;QAQkB,eAAO;QAAP,kCAAO;;uFDC/B,iBAAiB;cAT7B,SAAS;eAAC;gBACT,QAAQ,EAAE,WAAW;gBACrB,WAAW,EAAE,yBAAyB;gBACtC,IAAI,EAAE;oBACJ,+BAA+B,EAAE,MAAM;oBACvC,eAAe,EAAE,MAAM;iBACxB;gBACD,eAAe,EAAE,uBAAuB,CAAC,MAAM;aAChD;4HAE6C,GAAG;kBAA9C,SAAS;mBAAC,KAAK,EAAE,EAAE,MAAM,EAAE,IAAI,EAAE;YAwBlC,MAAM;kBADL,YAAY;mBAAC,OAAO","sourcesContent":["import { ChangeDetectionStrategy, ChangeDetectorRef, Component, ElementRef, HostListener, OnDestroy, ViewChild } from '@angular/core';\r\nimport { _HttpClient } from '@delon/theme';\r\nimport { Subject } from 'rxjs';\r\nimport { debounceTime, distinctUntilChanged, switchMap } from 'rxjs/operators';\r\nimport { MSTopbarNavLink, MSTopbarService } from '../../services/topbar.service';\r\n\r\n@Component({\r\n  selector: 'ms-search',\r\n  templateUrl: './search.component.html',\r\n  host: {\r\n    '[class.alain-ms__topbar-item]': 'true',\r\n    '[class.mr-md]': 'true',\r\n  },\r\n  changeDetection: ChangeDetectionStrategy.OnPush,\r\n})\r\nexport class MSSearchComponent implements OnDestroy {\r\n  @ViewChild('ipt', { static: true }) private ipt!: ElementRef<any>;\r\n  show = false;\r\n  q = '';\r\n  search$ = new Subject<string>();\r\n  list: any[] = [];\r\n\r\n  get l(): MSTopbarNavLink {\r\n    return this.srv.getNav('search');\r\n  }\r\n\r\n  constructor(http: _HttpClient, private srv: MSTopbarService, private cdr: ChangeDetectorRef) {\r\n    this.search$\r\n      .pipe(\r\n        debounceTime(300),\r\n        distinctUntilChanged(),\r\n        switchMap((q: string) => http.get('/user', { no: q, pi: 1, ps: 5 })),\r\n      )\r\n      .subscribe((res: any) => {\r\n        this.list = res.list;\r\n        this.cdr.detectChanges();\r\n      });\r\n  }\r\n\r\n  @HostListener('click')\r\n  _click(): void {\r\n    this.ipt.nativeElement.focus();\r\n    this.show = true;\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.search$.unsubscribe();\r\n  }\r\n}\r\n","<div class=\"alain-ms__search\" [ngClass]=\"{ 'alain-ms__search-active': show }\">\r\n  <input\r\n    class=\"alain-ms__search-ipt\"\r\n    #ipt\r\n    placeholder=\"{{ l.placeholder }}\"\r\n    nz-input\r\n    [(ngModel)]=\"q\"\r\n    (input)=\"search$.next($event.target?.value)\"\r\n    [nzAutocomplete]=\"searchAuto\"\r\n    (blur)=\"show = false\"\r\n  />\r\n  <i class=\"alain-ms__search-icon\" nz-icon nzType=\"search\"></i>\r\n  <i class=\"alain-ms__search-outline\"></i>\r\n  <nz-autocomplete #searchAuto class=\"asdlfkjlj\">\r\n    <nz-auto-option *ngFor=\"let item of list\" [nzValue]=\"item\">\r\n      {{ item }}\r\n    </nz-auto-option>\r\n  </nz-autocomplete>\r\n</div>\r\n"]}