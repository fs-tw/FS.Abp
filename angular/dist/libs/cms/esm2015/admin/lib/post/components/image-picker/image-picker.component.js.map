{"version":3,"file":"image-picker.component.js","sourceRoot":"","sources":["../../../../../../../../../libs/cms/admin/src/lib/post/components/image-picker/image-picker.component.ts","../../../../../../../../../libs/cms/admin/src/lib/post/components/image-picker/image-picker.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input, OnInit, TemplateRef, Output, EventEmitter } from '@angular/core';\r\n\r\nimport { NzUploadFile } from 'ng-zorro-antd/upload';\r\n\r\nimport { ToasterService } from '@abp/ng.theme.shared';\r\nimport { ConfigStateService,EnvironmentService } from '@abp/ng.core';\r\n\r\nexport class ImageFile {\r\n  fileName: string;\r\n  fileUrl: string;\r\n\r\n  constructor(fileName: string = '', fileUrl: string = '') {\r\n    this.fileName = fileName;\r\n    this.fileUrl = fileUrl;\r\n  }\r\n}\r\n\r\nexport class SaveFile {\r\n  isUpload: boolean;\r\n  file: File;\r\n  fileName: string;\r\n  fileUrl: string;\r\n\r\n  constructor(fileName: string, fileUrl: string, file: File) {\r\n    this.fileName = fileName;\r\n    this.fileUrl = fileUrl;\r\n    this.file = file;\r\n\r\n    this.isUpload = this.file != null;\r\n  }\r\n}\r\n\r\nclass ViewImage {\r\n  image: ImageFile;\r\n  isVisabled: boolean;\r\n\r\n  constructor() {\r\n    this.image = new ImageFile();\r\n    this.isVisabled = false;\r\n  }\r\n}\r\n\r\n@Component({\r\n  selector: 'image-picker',\r\n  templateUrl: './image-picker.component.html',\r\n  styleUrls: ['./image-picker.component.css']\r\n})\r\nexport class ImagePickerComponent implements OnInit {\r\n\r\n  /** 縮圖寬度，單位 px，預設 104px */\r\n  @Input() imageWidth: string = '104px';\r\n\r\n  /** 縮圖高度，單位 px ，預設 104px */\r\n  @Input() imageHeight: string = '104px';\r\n\r\n  /** 外框寬度，單位 px ，預設 104px */\r\n  @Input() borderWidth: string = '104px';\r\n\r\n  /** 外框高度，單位 px ，預設 104px */\r\n  @Input() borderHeight: string = '104px';\r\n\r\n  /** 上傳最大數量 */\r\n  @Input() maxImageCount: number = null;\r\n\r\n  /** 是否可同時選多張圖片 */\r\n  @Input() isMultiple: boolean = true;\r\n\r\n  /** 顯示圖片 Template ，縮圖比例功能會失效 */\r\n  @Input() imageTemplate: TemplateRef<any>;\r\n\r\n  /** 上傳圖片 Template，可完整替換成其他形式，如︰按鈕上傳 */\r\n  @Input() uploadTemplate: TemplateRef<any>;\r\n  \r\n  /** 上傳按鈕文字 Template，若 uploadTemplate 有值則無效 */\r\n  @Input() uploadTextTemplate: TemplateRef<any>;\r\n\r\n  /** 是否排列在同一行，同一行時行寬同 imageWidth */\r\n  @Input() inLine: boolean = true;\r\n\r\n  /** 上傳按鈕顯示於前面 */\r\n  @Input() showFrontButton: boolean = true;\r\n\r\n  /** 原已上傳圖片 */\r\n  @Input() existFiles: ImageFile[] = [];\r\n\r\n  /** 原已上傳圖片被刪除的檔名 */\r\n  private deleteFiles: string[] = [];\r\n\r\n  /** 本次上傳所顯示圖片 */\r\n  showFiles: ImageFile[] = [];\r\n\r\n  /** 本次上傳圖片 */\r\n  private uploadFiles: NzUploadFile[] = [];\r\n\r\n  /** 顯示預覽圖 modal */\r\n  viewImage: ViewImage = new ViewImage();\r\n\r\n  get canUpload(): boolean {\r\n    let imageNumber = this.existFiles.length + this.uploadFiles.length;\r\n    return this.maxImageCount == null || imageNumber < this.maxImageCount;\r\n  }\r\n\r\n  constructor(\r\n    private toasterService: ToasterService,\r\n    private environmentService:EnvironmentService,\r\n    private configStateService: ConfigStateService\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n  }\r\n\r\n  ngOnChanges() {\r\n    this.existFiles = this.existFiles\r\n      .filter(x => x.fileUrl)\r\n      .map(x => new ImageFile(x.fileName, this.getHttpUrl(x.fileUrl)));\r\n\r\n    this.uploadFiles = [];\r\n    this.showFiles = [];\r\n  }\r\n\r\n  clear() {\r\n    this.existFiles = [];\r\n    this.deleteFiles = [];\r\n    this.uploadFiles = [];\r\n    this.showFiles = [];\r\n  }\r\n\r\n  private getHttpUrl(url: string): string {\r\n    let result = url;\r\n    if (url.includes(\"http\")) return result;\r\n\r\n    return this.environmentService.getApiUrl() + url;\r\n  }\r\n\r\n  beforeUpload = (file: NzUploadFile): boolean => {\r\n    let isJpgOrPng = file.type === 'image/jpeg' || file.type === 'image/png';\r\n    if (!isJpgOrPng) {\r\n      this.toasterService.error(\"圖片格式須為 jpg 或 png\");\r\n      return false;\r\n    }\r\n\r\n    let fileName = file.name;\r\n\r\n    let hasExistImage = this.existFiles.findIndex(x => x.fileName == fileName) > -1;\r\n    let hasShowImage = this.showFiles.findIndex(x => x.fileName == fileName) > -1;\r\n    if (hasExistImage || hasShowImage) return false;\r\n\r\n\r\n    let imgFile: any = file;\r\n    this.getBase64(imgFile, (img) => {\r\n      if (!this.canUpload) {\r\n        this.toasterService.error(\"圖片數已達上限\");\r\n        return;\r\n      }\r\n\r\n      this.uploadFiles.push(imgFile);\r\n      this.showFiles.push(new ImageFile(fileName, img));\r\n    });\r\n\r\n    return false;\r\n  };\r\n\r\n  private getBase64(img: File, callback: (img: string) => void): void {\r\n    const reader = new FileReader();\r\n    reader.addEventListener('load', () => callback(reader.result!.toString()));\r\n    reader.readAsDataURL(img);\r\n  }\r\n\r\n  deleteFile(fileName: string) {\r\n    let inExistImage = this.existFiles.findIndex(x => x.fileName == fileName) > -1;\r\n    let inShowImage = this.showFiles.findIndex(x => x.fileName == fileName) > -1;\r\n\r\n    // 現有圖片刪除\r\n    if (inExistImage) {\r\n      this.existFiles = this.existFiles.filter(x => x.fileName != fileName);\r\n      this.deleteFiles.push(fileName);\r\n      return;\r\n    }\r\n\r\n    // 上傳圖片刪除\r\n    if (inShowImage) {\r\n      this.showFiles = this.showFiles.filter(x => x.fileName != fileName);\r\n      this.uploadFiles = this.uploadFiles.filter(x => x.name != fileName);\r\n    }\r\n\r\n  }\r\n\r\n  controllModal(state: boolean, image: ImageFile = new ImageFile()) {\r\n    this.viewImage.image = image;\r\n    this.viewImage.isVisabled = state;\r\n  }\r\n\r\n  getDeleteFileNames(): string[] {\r\n    return this.deleteFiles;\r\n  }\r\n\r\n  getUploadFiles(): SaveFile[] {\r\n    let existFiles = this.existFiles.filter(x => !this.deleteFiles.includes(x.fileName)).map(x => new SaveFile(x.fileName, x.fileUrl, null));\r\n    let updateFiles: SaveFile[] = this.uploadFiles.map((x: any) => new SaveFile(x.name, '', x));\r\n    \r\n    return existFiles.concat(updateFiles);\r\n  }\r\n\r\n}\r\n","<ng-template #Upload>\r\n    <nz-upload\r\n        class=\"avatar-uploader\" style=\"display: grid;\"\r\n        [nzListType]=\"uploadTemplate ? 'text' : 'picture'\"\r\n        [nzBeforeUpload]=\"beforeUpload\" \r\n        [nzMultiple]=\"isMultiple\"\r\n        >\r\n\r\n        <div *ngTemplateOutlet=\"uploadTemplate || UploadImage\"></div>\r\n        <ng-template #UploadImage>\r\n            <div class=\"divBorder divGridCenter\" [ngStyle]=\"{ 'width': borderWidth, 'height': borderHeight }\">\r\n                <div *ngTemplateOutlet=\"uploadTextTemplate || UploadText\"></div>\r\n            </div>\r\n        </ng-template>\r\n\r\n        <ng-template #UploadText>\r\n            <div style=\"font-size: 16px; text-align: center;\">\r\n                <div class=\"ant-upload-text\">Upload</div>\r\n            </div>\r\n        </ng-template>\r\n    </nz-upload>\r\n</ng-template>\r\n\r\n<ng-template #Image let-item>\r\n    <div class=\"divBorder imgGrid divGridCenter\" \r\n        [ngStyle]=\"{ 'width': borderWidth, 'height': borderHeight }\"\r\n        (click)=\"controllModal(true, item.file)\">\r\n\r\n        <div class=\"imgGridClose\">\r\n            <i (click)=\"deleteFile(item.file.fileName)\" nz-icon nzType=\"close\" nzTheme=\"outline\"></i>\r\n        </div>\r\n\r\n        <img [src]=\"item.file.fileUrl\" style=\"max-width: 100%;\" [ngStyle]=\"{ 'max-height': imageHeight }\" />\r\n    </div>\r\n</ng-template>\r\n\r\n<div [ngClass]=\"{ 'divGrid': inLine }\" [ngStyle]=\"{ 'grid-template-columns': inLine ? 'repeat(auto-fit, ' + borderWidth + ')' : 'unset' }\">\r\n    <!-- 上傳按鈕(前) -->\r\n    <ng-container *ngIf=\"canUpload && showFrontButton\">\r\n        <div *ngTemplateOutlet=\"Upload\"></div>\r\n    </ng-container>\r\n\r\n    <!-- 傳入的圖片 -->\r\n    <ng-container *ngFor=\"let item of existFiles; let i = index\">\r\n        <div *ngTemplateOutlet=\"imageTemplate || Image; context: {$implicit: { file: item, i: i }}\"></div>\r\n    </ng-container>\r\n\r\n    <!-- 上傳的圖片 -->\r\n    <ng-container *ngFor=\"let item of showFiles; let i = index\">\r\n        <div *ngTemplateOutlet=\"imageTemplate || Image; context: {$implicit: { file: item, i: i }}\"></div>\r\n    </ng-container>\r\n\r\n    <!-- 上傳按鈕(後) -->\r\n    <ng-container *ngIf=\"canUpload && !showFrontButton\">\r\n        <div *ngTemplateOutlet=\"Upload\"></div>\r\n    </ng-container>\r\n    \r\n</div>\r\n\r\n<nz-modal [nzOkText]=\"null\" nzCancelText=\"關閉\" [nzWidth]=\"1000\"\r\n        [nzTitle]=\"'預覽圖'\" \r\n        [(nzVisible)]=\"viewImage.isVisabled\" \r\n        (nzOnCancel)=\"controllModal(false, viewImage.image)\">\r\n    <div class=\"divGridCenter\">\r\n        <img [src]=\"viewImage.image.fileUrl\" style=\"max-width: 100%; max-height: 500px;\" />\r\n    </div>\r\n</nz-modal>"]}