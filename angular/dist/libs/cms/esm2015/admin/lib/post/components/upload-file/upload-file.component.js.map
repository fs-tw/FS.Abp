{"version":3,"file":"upload-file.component.js","sourceRoot":"","sources":["../../../../../../../../../libs/cms/admin/src/lib/post/components/upload-file/upload-file.component.ts","../../../../../../../../../libs/cms/admin/src/lib/post/components/upload-file/upload-file.component.html"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,KAAK,EAAU,MAAM,eAAe,CAAC;AAEzD,OAAO,EAAE,YAAY,EAAE,mBAAmB,EAAkB,MAAM,sBAAsB,CAAC;;;;;;;;;;ICgBrF,0BAAuC;IACrC,0BAAI;IAEF,yBAAG;IAAA,YAAU;IAAA,iBAAI;IACnB,iBAAK;IACL,0BAAI;IACF,4BAA2C;IAAxC,oNAAsB;IAAkB,4BAAE;IAAA,iBAAI;IACnD,iBAAK;IAEP,iBAAK;;;IANE,eAAU;IAAV,6BAAU;;ADjBrB,2FAA2F;AAC3F,uCAAuC;AACvC,oDAAoD;AACpD,mDAAmD;AAOnD,MAAM,OAAO,mBAAmB;IAO9B,YACU,mBAAwC;QAAxC,wBAAmB,GAAnB,mBAAmB,CAAqB;QALlD,kBAAa,GAAa,EAAE,CAAC;QAE7B,aAAQ,GAAmB,EAAE,CAAC;QAY9B,iBAAY,GAAG,CAAC,IAAkB,EAAW,EAAE;YAC7C,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBAChE,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;YACzD,IAAI,KAAK;gBAAE,OAAO,KAAK,CAAC;YACxB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAC3C,OAAO,KAAK,CAAC;QACf,CAAC,CAAC;IAZF,CAAC;IAED,QAAQ;IAER,CAAC;IAUD,MAAM,CAAC,GAAG;QACR,IAAI,CAAC,mBAAmB;aACvB,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC;aACtB,SAAS,CAAC,CAAC,MAA2B,EAAE,EAAE;YACzC,IAAI,MAAM,KAAK,YAAY,CAAC,MAAM,CAAC,OAAO,EAAE;gBAC1C,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC;aAC/D;QACH,CAAC,CAAC,CAAC;IACL,CAAC;;sFAjCU,mBAAmB;wDAAnB,mBAAmB;QCZhC,oCAAuG;QAA9E,wJAAyB;QAChD,4BAAgC;QAC9B,uBAA8B;QAChC,iBAAI;QACJ,4BAA2B;QAAA,sHAAiB;QAAA,iBAAI;QAClD,iBAAY;QAEZ,yBAAyB;QACzB,sCAA2G;QACzG,6BAAO;QACL,0BAAI;QACF,2BAAI;QAAA,6BAAE;QAAA,iBAAK;QACX,2BAAI;QAAA,kBAAC;QAAA,iBAAK;QACZ,iBAAK;QACP,iBAAQ;QACR,8BAAO;QACL,oEASK;QACP,iBAAQ;QACV,iBAAW;;QA3Bc,yCAAyB,oCAAA,oBAAA;QAQ5B,eAAwB;QAAxB,0CAAwB,2BAAA;QAQrB,eAAgB;QAAhB,2CAAgB;;uFDJ5B,mBAAmB;cAL/B,SAAS;eAAC;gBACT,QAAQ,EAAE,gBAAgB;gBAC1B,WAAW,EAAE,8BAA8B;gBAC3C,SAAS,EAAE,CAAC,6BAA6B,CAAC;aAC3C;sEAIC,aAAa;kBADZ,KAAK","sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\r\nimport { NzUploadFile } from 'ng-zorro-antd/upload';\r\nimport { Confirmation, ConfirmationService, ToasterService } from '@abp/ng.theme.shared';\r\n\r\n// import { Confirmation, ConfirmationService,ToasterService } from '@abp/ng.theme.shared';\r\n// import { Store } from '@ngxs/store';\r\n// import { NzModalRef } from 'ng-zorro-antd/modal';\r\n// import { FileService } from '@fs-tw/theme-core';\r\n\r\n@Component({\r\n  selector: 'fs-upload-file',\r\n  templateUrl: './upload-file.component.html',\r\n  styleUrls: ['./upload-file.component.css']\r\n})\r\nexport class UploadFileComponent implements OnInit {\r\n\r\n  @Input()\r\n  existFileUrls: string[] = [];\r\n\r\n  fileList: NzUploadFile[] = [];\r\n\r\n  constructor(\r\n    private confirmationService: ConfirmationService\r\n  ) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n\r\n  }\r\n\r\n  beforeUpload = (file: NzUploadFile): boolean => {\r\n    let exist = this.existFileUrls.findIndex(x => x == file.name) > -1 ||\r\n      this.fileList.findIndex(x => x.name == file.name) > -1;\r\n    if (exist) return false;\r\n    this.fileList = this.fileList.concat(file);\r\n    return false;\r\n  };\r\n\r\n  delete(url) {\r\n    this.confirmationService\r\n    .warn('確認刪除嗎？', '系統訊息')\r\n    .subscribe((status: Confirmation.Status) => {\r\n      if (status === Confirmation.Status.confirm) {\r\n        this.existFileUrls = this.existFileUrls.filter(x => x != url);\r\n      }\r\n    });\r\n  }\r\n\r\n  // fileUrl: string[] = [];\r\n  // tplModal: NzModalRef;\r\n  // loading: boolean = false;\r\n  // fileList: NzUploadFile[] = [];\r\n  // constructor(\r\n  //   private toasterService: ToasterService,\r\n  //   private confirmationService: ConfirmationService,\r\n  //   private fileService: FileService,\r\n  //   private store: Store,\r\n  // ) { }\r\n\r\n  // ngOnInit(): void {\r\n  // }\r\n\r\n  // getUrl(x: string) {    \r\n  //   if (x.includes('http')) {\r\n  //     return x;\r\n  //   } else {\r\n  //     return this.fileService.getFileByName(x);\r\n  //   }\r\n  // }\r\n\r\n  // getFileName(x: string) {\r\n  //   let splitStr = x.split(\"\\\\\");\r\n  //   return splitStr[splitStr.length - 1];\r\n  // }\r\n  \r\n\r\n  // save(): string[] {\r\n  //   this.loading = true;\r\n  //   const randomName = Array(32).fill(null).map(() => (Math.round(Math.random() * 16)).toString(16)).join('');\r\n  //   const formData = new FormData();\r\n  //   let urlList: string[] = this.existFileUrls;\r\n  //   this.fileList.forEach((file: any) => {\r\n  //     let url = `cms\\\\posts\\\\${randomName}\\\\${file.name}`;\r\n  //     urlList.push(url);\r\n  //     formData.append('files[]', file, url);\r\n  //   });    \r\n  //   this.fileService.uploadFileByFormData(formData).subscribe(() => {\r\n  //   }, (error) => {\r\n  //     this.loading = false;\r\n  //     this.toasterService.error(\"上傳失敗\");\r\n  //   });\r\n  //   return urlList;\r\n  // }\r\n}\r\n","\r\n\r\n<nz-upload nzType=\"drag\" [(nzFileList)]=\"fileList\" [nzBeforeUpload]=\"beforeUpload\" [nzMultiple]=\"true\">\r\n  <p class=\"ant-upload-drag-icon\">\r\n    <i nz-icon nzType=\"inbox\"></i>\r\n  </p>\r\n  <p class=\"ant-upload-text\">點擊此處或將檔案拖拽至此處進行上傳</p>\r\n</nz-upload>\r\n\r\n<div class=\"my-md\"></div>\r\n<nz-table #basicTable [nzData]=\"existFileUrls\"  nzSimple=\"false\" nzSize=\"small\" [nzShowPagination]=\"false\">\r\n  <thead>\r\n    <tr>\r\n      <th>檔名</th>\r\n      <th>-</th>\r\n    </tr>\r\n  </thead>\r\n  <tbody>\r\n    <tr *ngFor=\"let data of existFileUrls\">\r\n      <td>\r\n        <!-- <a [href]=\"getUrl(data)\">{{getFileName(data)}}</a> -->\r\n        <a>{{ data }}</a>\r\n      </td>\r\n      <td>\r\n        <a (click)=\"delete(data)\" class=\"text-red\">刪除</a>\r\n      </td>\r\n\r\n    </tr>\r\n  </tbody>\r\n</nz-table>"]}