{"version":3,"file":"upload-file.component.js","sourceRoot":"","sources":["../../../../../../../../../libs/cms/admin/src/lib/post/components/upload-file/upload-file.component.ts"],"names":[],"mappings":"AAAA,OAAO,EAAE,SAAS,EAAE,KAAK,EAAU,MAAM,eAAe,CAAC;AAEzD,OAAO,EAAE,YAAY,EAAE,mBAAmB,EAAkB,MAAM,sBAAsB,CAAC;AAEzF,MAAM,OAAO,QAAQ;IAInB,YAAY,WAAmB,EAAE,EAAE,UAAkB,EAAE;QACrD,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;IACzB,CAAC;CACF;AAED,MAAM,OAAO,QAAQ;IAMnB,YAAY,QAAgB,EAAE,OAAe,EAAE,IAAU;QACvD,IAAI,CAAC,QAAQ,GAAG,QAAQ,CAAC;QACzB,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QACvB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QAEjB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC;IACpC,CAAC;CACF;AAOD,MAAM,OAAO,mBAAmB;IAQ9B,YACU,mBAAwC;QAAxC,wBAAmB,GAAnB,mBAAmB,CAAqB;QANlD,eAAU,GAAe,EAAE,CAAC;QAE5B,aAAQ,GAAmB,EAAE,CAAC;QAa9B,iBAAY,GAAG,CAAC,IAAkB,EAAW,EAAE;YAC7C,IAAI,KAAK,GAAG,IAAI,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,QAAQ,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACtE,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,IAAI,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;YACzD,IAAI,KAAK;gBAAE,OAAO,KAAK,CAAC;YACxB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAC3C,OAAO,KAAK,CAAC;QACf,CAAC,CAAC;IAZF,CAAC;IAED,QAAQ;IAER,CAAC;IAUD,MAAM,CAAC,GAAG;QACR,IAAI,CAAC,mBAAmB;aACrB,IAAI,CAAC,QAAQ,EAAE,MAAM,CAAC;aACtB,SAAS,CAAC,CAAC,MAA2B,EAAE,EAAE;YACzC,IAAI,MAAM,KAAK,YAAY,CAAC,MAAM,CAAC,OAAO,EAAE;gBAC1C,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,IAAI,GAAG,CAAC,CAAC;aACzD;QACH,CAAC,CAAC,CAAC;IACP,CAAC;IAED,iBAAiB;QACf,IAAI,WAAW,GAAe,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAM,EAAE,EAAE,CAAC,IAAI,QAAQ,CAAC,CAAC,CAAC,IAAI,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC;QACzF,OAAO,WAAW,CAAC;IACrB,CAAC;;;YA5CF,SAAS,SAAC;gBACT,QAAQ,EAAE,gBAAgB;gBAC1B,w8BAA2C;;aAE5C;;;YA/BsB,mBAAmB;;;yBAkCvC,KAAK","sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\r\nimport { NzUploadFile } from 'ng-zorro-antd/upload';\r\nimport { Confirmation, ConfirmationService, ToasterService } from '@abp/ng.theme.shared';\r\n\r\nexport class FileInfo {\r\n  fileName: string;\r\n  fileUrl: string;\r\n\r\n  constructor(fileName: string = '', fileUrl: string = '') {\r\n    this.fileName = fileName;\r\n    this.fileUrl = fileUrl;\r\n  }\r\n}\r\n\r\nexport class FileData {\r\n  isUpload: boolean;\r\n  file: File;\r\n  fileName: string;\r\n  fileUrl: string;\r\n\r\n  constructor(fileName: string, fileUrl: string, file: File) {\r\n    this.fileName = fileName;\r\n    this.fileUrl = fileUrl;\r\n    this.file = file;\r\n\r\n    this.isUpload = this.file != null;\r\n  }\r\n}\r\n\r\n@Component({\r\n  selector: 'fs-upload-file',\r\n  templateUrl: './upload-file.component.html',\r\n  styleUrls: ['./upload-file.component.css']\r\n})\r\nexport class UploadFileComponent implements OnInit {\r\n\r\n  @Input()\r\n  existFiles: FileInfo[] = [];\r\n\r\n  fileList: NzUploadFile[] = [];\r\n\r\n\r\n  constructor(\r\n    private confirmationService: ConfirmationService\r\n  ) {\r\n\r\n  }\r\n\r\n  ngOnInit() {\r\n\r\n  }\r\n\r\n  beforeUpload = (file: NzUploadFile): boolean => {\r\n    let exist = this.existFiles.findIndex(x => x.fileName == file.name) > -1 ||\r\n      this.fileList.findIndex(x => x.name == file.name) > -1;\r\n    if (exist) return false;\r\n    this.fileList = this.fileList.concat(file);\r\n    return false;\r\n  };\r\n\r\n  delete(url) {\r\n    this.confirmationService\r\n      .warn('確認刪除嗎？', '系統訊息')\r\n      .subscribe((status: Confirmation.Status) => {\r\n        if (status === Confirmation.Status.confirm) {\r\n          this.existFiles = this.existFiles.filter(x => x != url);\r\n        }\r\n      });\r\n  }\r\n\r\n  getNewUploadFiles(): FileData[] {\r\n    let updateFiles: FileData[] = this.fileList.map((x: any) => new FileData(x.name, '', x));\r\n    return updateFiles;\r\n  }\r\n}\r\n"]}