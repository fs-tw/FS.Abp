<nz-spin nzTip="{{'Cms::FS.Message:Loading' |abpLocalization }}" [nzSpinning]="isLoading">

  <nz-card>

    <form nz-form #f="ngForm" se-container="1" labelWidth="150" *ngIf="data">
      <se label="{{'Cms::FS.Cms.BlogType'|abpLocalization}}">
        <nz-select [(ngModel)]="data.blogId" name="blogId" required>
          <nz-option *ngFor="let item of blogs" [nzValue]="item.id" [nzLabel]="item.displayName"></nz-option>
        </nz-select>
      </se>
      <se label="{{'Cms::FS.Blog.Enable' |abpLocalization }}" required>
        <nz-radio-group [(ngModel)]="data.disable" name="disable">
          <label nz-radio [nzValue]="false">{{'Cms::FS.Blog.Enable' |abpLocalization }}</label>
          <label nz-radio [nzValue]="true">{{'Cms::FS.Blog.Disable' |abpLocalization }}</label>
        </nz-radio-group>
      </se>
      <se label="{{'Cms::FS.Post.PublishDate'  |abpLocalization}}" required>
        <nz-date-picker nzShowTime name="startDate" [nzAllowClear]="false"
          [(ngModel)]="dateRange[0]"></nz-date-picker>
      </se>
      <se label="{{'Cms::FS.Post.PublishEndDate'  |abpLocalization}}" extra="{{'Cms::FS.Message:NullIsUnlimit'  |abpLocalization}}">
        <nz-date-picker nzShowTime name="endDate" [nzAllowClear]="true"
          [(ngModel)]="dateRange[1]"></nz-date-picker>
      </se>
      
      <se label="{{'Cms::FS.Post.Title'  |abpLocalization}}" error="" required>
        <input type="text" nz-input [(ngModel)]="data.title" name="title" required>
      </se>
      <se label="{{'Cms::FS.Post.Subtitle'  |abpLocalization}}">
        <input type="text" nz-input [(ngModel)]="data.subtitle" name="Subtitle">
      </se>
      <se label="{{'Cms::FS.Post.DisplayMode'  |abpLocalization}}" required>
        <nz-select [(ngModel)]="data.displayMode" name="type">
          <nz-option [nzValue]="0" nzLabel="{{'Cms::FS.Post.Content'  |abpLocalization}}"></nz-option>
          <nz-option [nzValue]="1" nzLabel="{{'Cms::FS.Post.Url'  |abpLocalization}}"></nz-option>
        </nz-select>
      </se>

      <se label="{{'Cms::FS.Post.Content'  |abpLocalization}}" *ngIf="data.displayMode == 0">

        <!-- <quill-editor [(ngModel)]="data.contents[0].fileId" [ngModelOptions]="{standalone: true}">
        </quill-editor> -->
      </se>


      <se label="{{'Cms::FS.Post.Url'  |abpLocalization}}" *ngIf="data.displayMode == 1">
        <input type="text" nz-input [(ngModel)]="data.linkUrl" name="url">
      </se>

      <se label="{{'Cms::FS.Post.AttachmentFileUrls'  |abpLocalization}}" optionalHelp="  {{'Cms::FS.Message:SuggestionImageSize'| abpLocalization}}：1080X608">
        <nz-tabset>
          <nz-tab nzTitle="{{'Cms::FS.Post.AttachmentImage'  |abpLocalization}}">
            <se>
              <image-picker #DefaultImagePicker [existFiles]="defaultImages" [uploadTextTemplate]="Upload"
                [imageTemplate]="Image" [inLine]="false" borderWidth="100%" borderHeight="132px"></image-picker>
            </se>
          </nz-tab>
          <nz-tab nzTitle="{{'Cms::FS.Post.AttachmentFile'  |abpLocalization}}">
            <se>
              <fs-upload-file  #DefaultUploadFile [existFiles]="defaultFiles"></fs-upload-file>
            </se>
          </nz-tab>
        </nz-tabset>
      </se>

      <!-- <se label="標籤">
        <fs-tag [postId]="data.id" [postTags]="data.postTags"></fs-tag>
      </se> -->

      <se>
        <button nz-button nzType="primary" (click)="save()" [disabled]="f.invalid">
          {{ !data.id ? ('AbpUi::Create'  |abpLocalization) : ('AbpUi::Save'  |abpLocalization) }}
        </button>
      </se>
    </form>
  </nz-card>

</nz-spin>


<ng-template #Upload>
  <div style="text-align: center;">
    <div style="color: #26d7eb; font-size: 48px;">
      <i nz-icon nzType="inbox" style="display: block;"></i>
    </div>
    <div style="font-size: 16px;">
     {{'Cms::FS.Message:DragOrClickHere'| abpLocalization}}
    </div>
  </div>
</ng-template>

<ng-template #Image let-item>
  <div nz-row style="border: 1px solid #ddd; border-right: 0px; margin-top: 5px;">
    <div nz-col nzSpan="4" class="imgItemDiv">
      <a class="text-blue" *ngIf="coverImage != item.file.fileName" (click)="coverImage = item.file.fileName">{{'Cms::FS.Post.SetAsCover'  |abpLocalization}}</a>
      <i nz-icon nzType="check" nzTheme="outline" style="font-size: 16px;" class="text-green"
        *ngIf="coverImage == item.file.fileName"></i>
    </div>
    <div nz-col nzSpan="8" class="imgItemDiv" style="cursor: pointer;"
      (click)="defaultImagePicker.controllModal(true, item.file)">
      <div style="width: 100%;">
        <img [src]="item.file.fileUrl" style="max-height: 40px;" />     
      </div>
    </div>
    <div nz-col nzSpan="8" class="imgItemDiv">
      <div style="width: 100%;">{{ item.file.fileName }}</div>
    </div>
    <div nz-col nzSpan="4" class="imgItemDiv">
      <div style="width: 100%;">
        <a class="text-red" (click)="deleteFile(item.file.fileName)">{{'AbpUi::Delete'  |abpLocalization}}</a>
      </div>
    </div>
  </div>
</ng-template>