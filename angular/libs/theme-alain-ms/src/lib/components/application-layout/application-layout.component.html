<ng-container *ngIf="store$ | async as store">
  <ms-topbar [allNav]="store.sidebarConfig.hasAllNav"></ms-topbar>
  <ms-sidebar *ngIf="store.sidebarConfig.hasSidebar"></ms-sidebar>
  <div class="brand-page-loading" [hidden]="!store.isFetching">
    <nz-spin nzSpinning></nz-spin>
  </div>
  <div class="alain-ms__body" [hidden]="store.isFetching">
    
    <service-layout
      [nav]="store.sidebarConfig.hasPageNav"
      [navConfig]="store.navConfig"
      [navList]="store.pageNavs"
    >
      <!-- todo:move to feature module
      <page-bar [subTitle]="subTitleTpl" [title]="titleTpl">
        <ng-template #titleTpl> {{ store.navConfig.doc }} </ng-template>
        <ng-template #subTitleTpl>
          <div class="text-orange">
            以下只展示部分组件，更多组件<a
              href="https://ng.ant.design"
              target="_blank"
              >ng.ant.design</a
            >
          </div>
        </ng-template>
        <button (click)="msg.success('clean')" nz-button>清理</button>
        <button (click)="msg.success('remove')" nz-button nzDanger>移除</button>
        <button (click)="msg.success('add')" nz-button nzType="primary">
          新增
        </button>
      </page-bar> -->
      <div *ngTemplateOutlet="FsPageBar"></div>
      <router-outlet></router-outlet>
    </service-layout>
  </div>
</ng-container>

<ng-template #FsPageBar>
  <page-bar [subTitle]="subTitleTpl" [title]="titleTpl">
    <ng-template #subTitleTpl>
      <button type="button" class="pri-btn" 
        *ngIf="!isCurrentPath && layoutStateService?.routesProcessor?.RouterState" 
        [routerLink]="[parentPath]">返回</button>
    </ng-template>
    <ng-template #titleTpl>
      <span *ngIf="layoutStateService?.routesProcessor?.RouterState">
        {{layoutStateService?.routesProcessor?.CurrentRoute?.name | abpLocalization}}
      </span>
    </ng-template>
  </page-bar>
</ng-template>