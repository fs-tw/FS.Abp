(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"F/qr":function(t,e,n){"use strict";n.r(e),n.d(e,"CreateEdition",function(){return kt}),n.d(e,"CreateTenant",function(){return jt}),n.d(e,"DEFAULT_SAAS_CREATE_FORM_PROPS",function(){return ae}),n.d(e,"DEFAULT_SAAS_EDIT_FORM_PROPS",function(){return ie}),n.d(e,"DEFAULT_SAAS_ENTITY_ACTIONS",function(){return te}),n.d(e,"DEFAULT_SAAS_ENTITY_PROPS",function(){return ne}),n.d(e,"DEFAULT_SAAS_TOOLBAR_ACTIONS",function(){return ee}),n.d(e,"DeleteEdition",function(){return Zt}),n.d(e,"DeleteTenant",function(){return wt}),n.d(e,"EditionService",function(){return Rt}),n.d(e,"EditionsComponent",function(){return Lt}),n.d(e,"EditionsUsageWidgetComponent",function(){return qt}),n.d(e,"GetEditionById",function(){return It}),n.d(e,"GetEditions",function(){return Gt}),n.d(e,"GetLatestTenants",function(){return Ut}),n.d(e,"GetTenantById",function(){return Et}),n.d(e,"GetTenants",function(){return Ft}),n.d(e,"GetUsageStatistics",function(){return At}),n.d(e,"LatestTenantsWidgetComponent",function(){return _t}),n.d(e,"SAAS_CREATE_FORM_PROP_CONTRIBUTORS",function(){return re}),n.d(e,"SAAS_EDIT_FORM_PROP_CONTRIBUTORS",function(){return le}),n.d(e,"SAAS_ENTITY_ACTION_CONTRIBUTORS",function(){return se}),n.d(e,"SAAS_ENTITY_PROP_CONTRIBUTORS",function(){return oe}),n.d(e,"SAAS_TOOLBAR_ACTION_CONTRIBUTORS",function(){return ce}),n.d(e,"SaasExtensionsGuard",function(){return ue}),n.d(e,"SaasModule",function(){return be}),n.d(e,"SaasState",function(){return Dt}),n.d(e,"SaasStateService",function(){return he}),n.d(e,"TenantService",function(){return Bt}),n.d(e,"TenantsComponent",function(){return Vt}),n.d(e,"UpdateEdition",function(){return Mt}),n.d(e,"UpdateTenant",function(){return Nt}),n.d(e,"\u02750",function(){return xt}),n.d(e,"\u0275a",function(){return Vt}),n.d(e,"\u0275ba",function(){return oe}),n.d(e,"\u0275bb",function(){return re}),n.d(e,"\u0275bc",function(){return le}),n.d(e,"\u0275c",function(){return Dt}),n.d(e,"\u0275d",function(){return Bt}),n.d(e,"\u0275e",function(){return Rt}),n.d(e,"\u0275f",function(){return Ft}),n.d(e,"\u0275g",function(){return jt}),n.d(e,"\u0275h",function(){return Nt}),n.d(e,"\u0275i",function(){return wt}),n.d(e,"\u0275j",function(){return Gt}),n.d(e,"\u0275k",function(){return kt}),n.d(e,"\u0275l",function(){return Mt}),n.d(e,"\u0275m",function(){return Zt}),n.d(e,"\u0275n",function(){return At}),n.d(e,"\u0275o",function(){return Ut}),n.d(e,"\u0275t",function(){return Lt}),n.d(e,"\u0275u",function(){return qt}),n.d(e,"\u0275v",function(){return _t}),n.d(e,"\u0275w",function(){return pe}),n.d(e,"\u0275x",function(){return ue}),n.d(e,"\u0275y",function(){return se}),n.d(e,"\u0275z",function(){return ce});var a=n("mrSG"),i=n("HmNo"),s=n("1REP"),c=n("J7bl"),o=n("fXoL"),r=n("AcyG"),l=n("vkgz"),u=n("nYR2"),d=n("eIep"),p=n("IzEk"),b=n("lJxs"),h=n("CqXF"),m=n("3Pt+"),g=n("LRne"),f=n("2Vo4"),v=n("rBLV"),S=n("1kSV"),y=n("ofXK");function T(t,e){1&t&&(o.ac(0,"h3"),o.Sc(1),o.pc(2,"abpLocalization"),o.Zb()),2&t&&(o.Gb(1),o.Tc(o.qc(2,1,"AbpFeatureManagement::Features")))}function C(t,e){1&t&&o.Wb(0)}const O=function(t){return{$implicit:t}};function F(t,e){if(1&t){const t=o.bc();o.Yb(0),o.ac(1,"div",22),o.ac(2,"input",23),o.kc("ngModelChange",function(e){return o.Ic(t),o.oc().$implicit.value=e})("ngModelChange",function(e){o.Ic(t);const n=o.oc().$implicit;return o.oc(5).onCheckboxClick(e,n)}),o.Zb(),o.ac(3,"label",24),o.Sc(4),o.Zb(),o.Qc(5,C,1,0,"ng-container",25),o.Zb(),o.Xb()}if(2&t){const t=o.oc().$implicit;o.oc(3);const e=o.Fc(6);o.Gb(2),o.vc("id",t.name)("ngModel",t.value),o.Gb(1),o.vc("htmlFor",t.name),o.Gb(1),o.Tc(t.displayName),o.Gb(1),o.vc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.zc(6,O,t.description))}}function E(t,e){1&t&&o.Wb(0)}function j(t,e){if(1&t){const t=o.bc();o.Yb(0),o.ac(1,"div",26),o.ac(2,"label",27),o.Sc(3),o.Zb(),o.ac(4,"input",28),o.kc("ngModelChange",function(e){return o.Ic(t),o.oc().$implicit.value=e}),o.Zb(),o.Qc(5,E,1,0,"ng-container",25),o.Zb(),o.Xb()}if(2&t){const t=o.oc().$implicit;o.oc(3);const e=o.Fc(6);o.Gb(2),o.vc("htmlFor",t.name),o.Gb(1),o.Tc(t.displayName),o.Gb(1),o.vc("id",t.name)("ngModel",t.value)("abpFeatureManagementFreeText",t),o.Gb(1),o.vc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.zc(7,O,t.description))}}function N(t,e){if(1&t&&(o.ac(0,"option",32),o.Sc(1),o.pc(2,"abpLocalization"),o.Zb()),2&t){const t=e.$implicit;o.vc("ngValue",t.value),o.Gb(1),o.Uc(" ",o.qc(2,2,(null==t.displayText?null:t.displayText.resourceName)+"::"+(null==t.displayText?null:t.displayText.name)),"")}}function w(t,e){1&t&&o.Wb(0)}function G(t,e){if(1&t){const t=o.bc();o.Yb(0),o.ac(1,"div",26),o.ac(2,"label",27),o.Sc(3),o.Zb(),o.ac(4,"select",30),o.kc("ngModelChange",function(e){return o.Ic(t),o.oc(2).$implicit.value=e}),o.Qc(5,N,3,4,"option",31),o.Zb(),o.Qc(6,w,1,0,"ng-container",25),o.Zb(),o.Xb()}if(2&t){const t=o.oc(2).$implicit;o.oc(3);const e=o.Fc(6),n=o.oc(2);o.Gb(2),o.vc("htmlFor",t.name),o.Gb(1),o.Tc(t.displayName),o.Gb(1),o.vc("id",t.name)("ngModel",t.value),o.Gb(1),o.vc("ngForOf",null==t.valueType.itemSource?null:t.valueType.itemSource.items)("ngForTrackBy",n.track.by("value")),o.Gb(1),o.vc("ngTemplateOutlet",e)("ngTemplateOutletContext",o.zc(8,O,t.description))}}function I(t,e){if(1&t&&(o.Yb(0),o.Qc(1,G,7,10,"ng-container",29),o.Xb()),2&t){const t=o.oc().$implicit;o.Gb(1),o.vc("ngIf",null==t.valueType.itemSource||null==t.valueType.itemSource.items?null:t.valueType.itemSource.items.length)}}function k(t,e){if(1&t&&(o.Yb(0),o.Sc(1),o.Xb()),2&t){const t=o.oc().$implicit;o.Gb(1),o.Tc(t.displayName)}}function M(t,e){if(1&t){const t=o.bc();o.ac(0,"div",19),o.kc("keyup.enter",function(){return o.Ic(t),o.oc(5).save()}),o.Qc(1,F,6,8,"ng-container",20),o.Qc(2,j,6,9,"ng-container",20),o.Qc(3,I,2,1,"ng-container",20),o.Qc(4,k,2,1,"ng-container",21),o.Zb()}if(2&t){const t=e.$implicit,n=o.oc(5);o.vc("ngStyle",t.style)("ngSwitch",null==t.valueType?null:t.valueType.name),o.Gb(1),o.vc("ngSwitchCase",n.valueTypes.ToggleStringValueType),o.Gb(1),o.vc("ngSwitchCase",n.valueTypes.FreeTextStringValueType),o.Gb(1),o.vc("ngSwitchCase",n.valueTypes.SelectionStringValueType)}}function Z(t,e){if(1&t&&(o.ac(0,"h4"),o.Sc(1),o.Zb(),o.Vb(2,"hr",17),o.Qc(3,M,5,5,"div",18)),2&t){const t=o.oc().$implicit,e=o.oc(3);o.Gb(1),o.Tc(e.selectedGroupDisplayName),o.Gb(2),o.vc("ngForOf",e.features[t.name])("ngForTrackBy",e.track.by("id"))}}function A(t,e){if(1&t&&(o.ac(0,"li",14),o.ac(1,"a",15),o.Sc(2),o.Zb(),o.Qc(3,Z,4,3,"ng-template",16),o.Zb()),2&t){const t=e.$implicit;o.vc("ngbNavItem",t.displayName),o.Gb(2),o.Tc(t.displayName)}}function U(t,e){if(1&t&&(o.ac(0,"small",34),o.Sc(1),o.Zb()),2&t){const t=o.oc().$implicit;o.Gb(1),o.Tc(t)}}function R(t,e){1&t&&o.Qc(0,U,2,1,"small",33),2&t&&o.vc("ngIf",e.$implicit)}function B(t,e){1&t&&(o.ac(0,"div",35),o.Sc(1),o.pc(2,"abpLocalization"),o.Zb()),2&t&&(o.Gb(1),o.Uc(" ",o.qc(2,1,"AbpFeatureManagement::NoFeatureFoundMessage")," "))}function D(t,e){if(1&t){const t=o.bc();o.ac(0,"div",5),o.ac(1,"div",6),o.ac(2,"ul",7,8),o.kc("activeIdChange",function(e){return o.Ic(t),o.oc(2).selectedGroupDisplayName=e}),o.Qc(4,A,4,2,"li",9),o.Zb(),o.Zb(),o.Qc(5,R,1,1,"ng-template",null,10,o.Rc),o.ac(7,"div",11),o.Vb(8,"div",12),o.Zb(),o.Qc(9,B,3,3,"div",13),o.Zb()}if(2&t){const t=o.Fc(3),e=o.oc(2);o.Gb(2),o.vc("activeId",e.selectedGroupDisplayName),o.Gb(2),o.vc("ngForOf",e.groups)("ngForTrackBy",e.track.by("name")),o.Gb(4),o.vc("ngbNavOutlet",t),o.Gb(1),o.vc("ngIf",!e.groups.length)}}function x(t,e){if(1&t){const t=o.bc();o.ac(0,"abp-button",39),o.kc("click",function(){return o.Ic(t),o.oc(3).save()}),o.Sc(1),o.pc(2,"abpLocalization"),o.Zb()}if(2&t){const t=o.oc(3);o.vc("disabled",t.modalBusy),o.Gb(1),o.Uc(" ",o.qc(2,2,"AbpFeatureManagement::Save")," ")}}function L(t,e){if(1&t&&(o.ac(0,"button",36,37),o.Sc(2),o.pc(3,"abpLocalization"),o.Zb(),o.Qc(4,x,3,4,"abp-button",38)),2&t){const t=o.oc(2);o.Gb(2),o.Uc(" ",o.qc(3,2,"AbpFeatureManagement::Cancel")," "),o.Gb(2),o.vc("ngIf",t.groups.length)}}function V(t,e){if(1&t){const t=o.bc();o.ac(0,"abp-modal",1),o.kc("visibleChange",function(e){return o.Ic(t),o.oc().visible=e}),o.Qc(1,T,3,3,"ng-template",null,2,o.Rc),o.Qc(3,D,10,5,"ng-template",null,3,o.Rc),o.Qc(5,L,5,4,"ng-template",null,4,o.Rc),o.Zb()}if(2&t){const t=o.oc();o.vc("visible",t.visible)("busy",t.modalBusy)}}let q=(()=>{class t{constructor(t){this.restService=t,this.apiName="AbpFeatureManagement",this.get=(t,e)=>this.restService.request({method:"GET",url:"/api/feature-management/features",params:{providerName:t,providerKey:e}},{apiName:this.apiName}),this.update=(t,e,n)=>this.restService.request({method:"PUT",url:"/api/feature-management/features",params:{providerName:t,providerKey:e},body:n},{apiName:this.apiName})}}return t.\u0275fac=function(e){return new(e||t)(o.hc(i.U))},t.\u0275prov=Object(o.Qb)({factory:function(){return new t(Object(o.hc)(i.U))},token:t,providedIn:"root"}),t})();var _=function(t){return t.ToggleStringValueType="ToggleStringValueType",t.FreeTextStringValueType="FreeTextStringValueType",t.SelectionStringValueType="SelectionStringValueType",t}({});let Q=(()=>{class t{constructor(t,e,n,a,i){this.track=t,this.service=e,this.store=n,this.configState=a,this.appConfigService=i,this.groups=[],this.valueTypes=_,this.visibleChange=new o.q,this.modalBusy=!1}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this.visibleChange.emit(t),t&&this.openModal())}openModal(){if(!this.providerName)throw new Error("providerName is required.");this.getFeatures()}getFeatures(){this.service.get(this.providerName,this.providerKey).subscribe(t=>{this.groups=t.groups.map(({name:t,displayName:e})=>({name:t,displayName:e})),this.selectedGroupDisplayName=this.groups[0].displayName,this.features=t.groups.reduce((t,e)=>Object.assign(Object.assign({},t),{[e.name]:P(e.features,document.body.dir)}),{})})}save(){if(this.modalBusy)return;const t=[];Object.keys(this.features).forEach(e=>{this.features[e].forEach(e=>{e.value!==e.initialValue&&t.push({name:e.name,value:""+e.value})})}),t.length?(this.modalBusy=!0,this.service.update(this.providerName,this.providerKey,{features:t}).pipe(Object(u.a)(()=>this.modalBusy=!1)).subscribe(()=>{this.visible=!1,this.providerKey||this.appConfigService.get().pipe(Object(l.a)(t=>this.configState.setState(t))).subscribe()})):this.visible=!1}onCheckboxClick(t,e){t?this.checkToggleAncestors(e):this.uncheckToggleDescendants(e)}uncheckToggleDescendants(t){this.findAllDescendantsOfByType(t,_.ToggleStringValueType).forEach(t=>this.setFeatureValue(t,!1))}checkToggleAncestors(t){this.findAllAncestorsOfByType(t,_.ToggleStringValueType).forEach(t=>this.setFeatureValue(t,!0))}findAllAncestorsOfByType(t,e){let n=this.findParentByType(t,e);const a=[];for(;n;)a.push(n),n=this.findParentByType(n,e);return a}findAllDescendantsOfByType(t,e){const n=[],a=[t];for(;a.length;){const t=a.pop(),i=this.findChildrenByType(t,e);n.push(...i),a.push(...i)}return n}findParentByType(t,e){return this.getCurrentGroup().find(n=>n.valueType.name===e&&n.name===t.parentName)}findChildrenByType(t,e){return this.getCurrentGroup().filter(n=>n.valueType.name===e&&n.parentName===t.name)}getCurrentGroup(){var t;return null!==(t=this.features[this.selectedGroupDisplayName])&&void 0!==t?t:[]}setFeatureValue(t,e){t.value=e}}return t.\u0275fac=function(e){return new(e||t)(o.Ub(i.eb),o.Ub(q),o.Ub(r.g),o.Ub(i.m),o.Ub(i.b))},t.\u0275cmp=o.Ob({type:t,selectors:[["abp-feature-management"]],inputs:{visible:"visible",providerKey:"providerKey",providerName:"providerName"},outputs:{visibleChange:"visibleChange"},exportAs:["abpFeatureManagement"],decls:1,vars:1,consts:[["size","lg",3,"visible","busy","visibleChange",4,"ngIf"],["size","lg",3,"visible","busy","visibleChange"],["abpHeader",""],["abpBody",""],["abpFooter",""],[1,"row"],[1,"col-md-4"],["ngbNav","","orientation","vertical",1,"nav-pills",3,"activeId","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem",4,"ngFor","ngForOf","ngForTrackBy"],["descTmp",""],[1,"col-md-8"],[3,"ngbNavOutlet"],["class","mx-3",4,"ngIf"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[1,"mt-2","mb-3"],["class","mt-2",3,"ngStyle","ngSwitch","keyup.enter",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-2",3,"ngStyle","ngSwitch","keyup.enter"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"custom-checkbox","custom-control"],["type","checkbox",1,"custom-control-input",3,"id","ngModel","ngModelChange"],[1,"custom-control-label",3,"htmlFor"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"form-group"],[3,"htmlFor"],["type","text",1,"form-control",3,"id","ngModel","abpFeatureManagementFreeText","ngModelChange"],[4,"ngIf"],[1,"form-control","custom-select",3,"id","ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngValue"],["class","form-text text-muted",4,"ngIf"],[1,"form-text","text-muted"],[1,"mx-3"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click",4,"ngIf"],["iconClass","fa fa-check",3,"disabled","click"]],template:function(t,e){1&t&&o.Qc(0,V,7,2,"abp-modal",0),2&t&&o.vc("ngIf",e.visible)},directives:function(){return[y.q,s.h,S.k,y.p,S.p,S.m,S.n,S.l,y.r,y.s,y.t,y.u,m.c,m.q,m.t,y.v,m.e,$,m.y,m.u,m.C,s.b]},pipes:function(){return[i.H]},encapsulation:2}),t})();function P(t,e){const n=`margin-${"rtl"===e?"right":"left"}.px`;return t.map(t=>{var e;const a=(null===(e=t.valueType)||void 0===e?void 0:e.name)===_.ToggleStringValueType?"true"===(t.value||"").toLowerCase():t.value;return Object.assign(Object.assign({},t),{value:a,initialValue:a,style:{[n]:20*t.depth}})})}const z={numeric:"number",default:"text"};let $=(()=>{class t{set feature(t){this._feature=t,this.setInputType()}get feature(){return this._feature}setInputType(){var t,e,n,a;const i=null===(n=null===(e=null===(t=this.feature)||void 0===t?void 0:t.valueType)||void 0===e?void 0:e.validator)||void 0===n?void 0:n.name.toLowerCase();this.type=null!==(a=z[i])&&void 0!==a?a:z.default}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=o.Pb({type:t,selectors:[["input","abpFeatureManagementFreeText",""]],hostVars:1,hostBindings:function(t,e){2&t&&o.dc("type",e.type)},inputs:{feature:["abpFeatureManagementFreeText","feature"]},exportAs:["inputAbpFeatureManagementFreeText"]}),t})(),K=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.Sb({type:t}),t.\u0275inj=o.Rb({imports:[[i.o,s.n,S.o,r.c.forFeature([])]]}),t})();var H=n("iWZL"),W=n("tyNb");function Y(t,e){if(1&t){const t=o.bc();o.Yb(0),o.ac(1,"div",6),o.ac(2,"div",7),o.ac(3,"h1",8),o.Sc(4),o.pc(5,"abpLocalization"),o.Zb(),o.Zb(),o.ac(6,"div",9),o.Vb(7,"abp-breadcrumb"),o.Zb(),o.ac(8,"div",10),o.Vb(9,"abp-page-toolbar",11),o.Zb(),o.Zb(),o.ac(10,"div",12),o.ac(11,"div",13),o.ac(12,"div",14),o.ac(13,"div",15),o.ac(14,"div",10),o.ac(15,"div",16),o.ac(16,"input",17),o.kc("ngModelChange",function(e){return o.Ic(t),o.oc().list.filter=e}),o.pc(17,"abpLocalization"),o.Zb(),o.ac(18,"div",18),o.ac(19,"button",19),o.kc("click",function(){return o.Ic(t),o.oc().list.get()}),o.Vb(20,"i",20),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.ac(21,"div",13),o.Vb(22,"abp-extensible-table",21),o.pc(23,"async"),o.Zb(),o.Zb(),o.Xb()}if(2&t){const t=e.ngIf,n=o.oc();o.Gb(4),o.Tc(o.qc(5,7,"Saas::Editions")),o.Gb(5),o.vc("record",t),o.Gb(7),o.vc("placeholder",o.qc(17,9,"AbpUi::PagerSearch"))("ngModel",n.list.filter),o.Gb(6),o.vc("data",t)("recordsTotal",o.qc(23,11,n.totalCount$))("list",n.list)}}function X(t,e){if(1&t&&(o.ac(0,"h3"),o.Sc(1),o.pc(2,"abpLocalization"),o.Zb()),2&t){const t=o.oc();o.Gb(1),o.Tc(o.qc(2,1,null!=t.selected&&t.selected.id?"Saas::Edit":"Saas::NewEdition"))}}function J(t,e){if(1&t){const t=o.bc();o.ac(0,"form",22),o.kc("ngSubmit",function(){return o.Ic(t),o.oc().save()}),o.ac(1,"div",23),o.Vb(2,"abp-extensible-form",24),o.Zb(),o.Zb()}if(2&t){const t=o.oc();o.vc("formGroup",t.editionForm),o.Gb(2),o.vc("selectedRecord",t.selected)}}function tt(t,e){if(1&t){const t=o.bc();o.ac(0,"button",25,26),o.Sc(2),o.pc(3,"abpLocalization"),o.Zb(),o.ac(4,"abp-button",27),o.kc("click",function(){return o.Ic(t),o.oc().save()}),o.Sc(5),o.pc(6,"abpLocalization"),o.Zb()}if(2&t){const t=o.oc();o.Gb(2),o.Uc(" ",o.qc(3,3,"Saas::Cancel")," "),o.Gb(2),o.vc("disabled",null==t.editionForm?null:t.editionForm.invalid),o.Gb(1),o.Tc(o.qc(6,5,"AbpIdentity::Save"))}}function et(t,e){if(1&t){const t=o.bc();o.ac(0,"abp-feature-management",28),o.kc("visibleChange",function(e){return o.Ic(t),o.oc().visibleFeatures=e}),o.Zb()}if(2&t){const t=o.oc();o.vc("visible",t.visibleFeatures)("providerKey",t.providerKey)}}const nt=function(){return{value:"E"}},at=function(t){return{value:t}},it=function(t){return{value:t,twoWay:!0}},st=function(t,e,n){return{providerName:t,providerKey:e,visible:n}},ct=function(t){return{visibleChange:t}},ot=function(t,e){return{inputs:t,outputs:e,componentKey:"FeatureManagement.FeatureManagementComponent"}},rt=["tenantModalTemplate"],lt=["connectionStringModalTemplate"];function ut(t,e){if(1&t){const t=o.bc();o.Yb(0),o.ac(1,"div",8),o.ac(2,"div",9),o.ac(3,"h1",10),o.Sc(4),o.pc(5,"abpLocalization"),o.Zb(),o.Zb(),o.ac(6,"div",11),o.Vb(7,"abp-breadcrumb"),o.Zb(),o.ac(8,"div",12),o.Vb(9,"abp-page-toolbar",13),o.Zb(),o.Zb(),o.ac(10,"div",14),o.ac(11,"div",15),o.ac(12,"div",16),o.ac(13,"div",17),o.ac(14,"div",12),o.ac(15,"div",18),o.ac(16,"input",19),o.kc("ngModelChange",function(e){return o.Ic(t),o.oc().list.filter=e}),o.pc(17,"abpLocalization"),o.Zb(),o.ac(18,"div",20),o.ac(19,"button",21),o.kc("click",function(){return o.Ic(t),o.oc().list.get()}),o.Vb(20,"i",22),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.ac(21,"div",15),o.Vb(22,"abp-extensible-table",23),o.pc(23,"async"),o.Zb(),o.Zb(),o.Xb()}if(2&t){const t=e.ngIf,n=o.oc();o.Gb(4),o.Tc(o.qc(5,7,"Saas::Tenants")),o.Gb(5),o.vc("record",t),o.Gb(7),o.vc("placeholder",o.qc(17,9,"AbpUi::PagerSearch"))("ngModel",n.list.filter),o.Gb(6),o.vc("data",t)("recordsTotal",o.qc(23,11,n.totalCount$))("list",n.list)}}function dt(t,e){if(1&t&&(o.ac(0,"h3"),o.Sc(1),o.pc(2,"abpLocalization"),o.Zb()),2&t){const t=o.oc();o.Gb(1),o.Tc(o.qc(2,1,t.selectedModalContent.title))}}function pt(t,e){1&t&&o.Wb(0)}function bt(t,e){if(1&t&&o.Qc(0,pt,1,0,"ng-container",24),2&t){const t=o.oc();o.vc("ngTemplateOutlet",null==t.selectedModalContent?null:t.selectedModalContent.template)}}function ht(t,e){if(1&t){const t=o.bc();o.ac(0,"button",25,26),o.Sc(2),o.pc(3,"abpLocalization"),o.Zb(),o.ac(4,"abp-button",27),o.kc("click",function(){return o.Ic(t),o.oc().save()}),o.Sc(5),o.pc(6,"abpLocalization"),o.Zb()}if(2&t){const t=o.oc();o.Gb(2),o.Uc(" ",o.qc(3,3,"Saas::Cancel")," "),o.Gb(2),o.vc("disabled",t.isDisabledSaveButton),o.Gb(1),o.Tc(o.qc(6,5,"AbpIdentity::Save"))}}function mt(t,e){if(1&t){const t=o.bc();o.ac(0,"form",29),o.kc("ngSubmit",function(){return o.Ic(t),o.oc(2).save()}),o.ac(1,"div",30),o.Vb(2,"abp-extensible-form",31),o.Zb(),o.Zb()}if(2&t){const t=o.oc(2);o.vc("formGroup",t.tenantForm),o.Gb(2),o.vc("selectedRecord",t.selected)}}function gt(t,e){if(1&t&&o.Qc(0,mt,3,2,"form",28),2&t){const t=o.oc();o.vc("ngIf",t.tenantForm)}}function ft(t,e){1&t&&(o.ac(0,"div",33),o.ac(1,"label",38),o.Sc(2),o.pc(3,"abpLocalization"),o.Zb(),o.Vb(4,"input",39),o.Zb()),2&t&&(o.Gb(2),o.Tc(o.qc(3,1,"Saas::DisplayName:DefaultConnectionString")))}function vt(t,e){if(1&t){const t=o.bc();o.ac(0,"form",32),o.kc("ngSubmit",function(){return o.Ic(t),o.oc().save()}),o.ac(1,"div",30),o.ac(2,"div",33),o.ac(3,"div",34),o.ac(4,"input",35),o.kc("ngModelChange",function(e){return o.Ic(t),o.oc().onSharedDatabaseChange(e)}),o.Zb(),o.ac(5,"label",36),o.Sc(6),o.pc(7,"abpLocalization"),o.Zb(),o.Zb(),o.Zb(),o.Qc(8,ft,5,3,"div",37),o.Zb(),o.Zb()}if(2&t){const t=o.oc();o.vc("formGroup",t.defaultConnectionStringForm),o.Gb(6),o.Tc(o.qc(7,3,"Saas::DisplayName:UseSharedDatabase")),o.Gb(2),o.vc("ngIf",!t.useSharedDatabase)}}function St(t,e){if(1&t){const t=o.bc();o.ac(0,"abp-feature-management",40),o.kc("visibleChange",function(e){return o.Ic(t),o.oc().visibleFeatures=e}),o.Zb()}if(2&t){const t=o.oc();o.vc("visible",t.visibleFeatures)("providerKey",t.providerKey)}}const yt=function(){return{value:"T"}};function Tt(t,e){if(1&t){const t=o.bc();o.ac(0,"div",1),o.ac(1,"div",2),o.ac(2,"div",3),o.ac(3,"h5",4),o.Sc(4),o.pc(5,"abpLocalization"),o.Zb(),o.Zb(),o.ac(6,"div",5),o.ac(7,"div",6),o.ac(8,"abp-chart",7,8),o.kc("initialized",function(e){return o.Ic(t),o.oc().initialize(e)}),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.Zb()}if(2&t){const t=o.oc();o.Gb(4),o.Tc(o.qc(5,4,"Saas::EditionUsageStatistics")),o.Gb(4),o.vc("data",t.chartData)("width",t.width)("height",t.height)}}function Ct(t,e){if(1&t&&(o.ac(0,"tr"),o.ac(1,"th"),o.Sc(2),o.Zb(),o.ac(3,"td"),o.Sc(4),o.Zb(),o.ac(5,"td"),o.Sc(6),o.Zb(),o.Zb()),2&t){const t=e.$implicit,n=e.index;o.Gb(2),o.Tc(n+1),o.Gb(2),o.Tc(t.name),o.Gb(2),o.Tc(t.editionName)}}function Ot(t,e){if(1&t&&(o.ac(0,"div",1),o.ac(1,"div",2),o.ac(2,"div",3),o.ac(3,"h5",4),o.Sc(4,"Latest tenants"),o.Zb(),o.Zb(),o.ac(5,"div",5),o.ac(6,"div"),o.ac(7,"table",6),o.ac(8,"thead"),o.ac(9,"tr"),o.ac(10,"th"),o.Sc(11,"#"),o.Zb(),o.ac(12,"th"),o.Sc(13),o.pc(14,"abpLocalization"),o.Zb(),o.ac(15,"th"),o.Sc(16),o.pc(17,"abpLocalization"),o.Zb(),o.Zb(),o.Zb(),o.ac(18,"tbody"),o.Qc(19,Ct,7,3,"tr",7),o.pc(20,"async"),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.Zb(),o.Zb()),2&t){const t=o.oc();o.Gb(6),o.Nc("min-height",t.minHeight,"px"),o.Gb(7),o.Tc(o.qc(14,6,"Saas::Name")),o.Gb(3),o.Tc(o.qc(17,8,"Saas::EditionName")),o.Gb(3),o.vc("ngForOf",o.qc(20,10,t.datas$))("ngForTrackBy",t.trackByFn)}}let Ft=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Get Tenant",t})(),Et=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Get Tenant By Id",t})(),jt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Create Tenant",t})(),Nt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Update Tenant",t})(),wt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Delete Tenant",t})(),Gt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Get Edition",t})(),It=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Get Edition By Id",t})(),kt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Create Edition",t})(),Mt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Update Edition",t})(),Zt=(()=>{class t{constructor(t){this.payload=t}}return t.type="[Saas] Delete Edition",t})(),At=(()=>{class t{}return t.type="[Saas] Get Usage Statistics",t})(),Ut=(()=>{class t{}return t.type="[Saas] Get Latest Tenatns",t})(),Rt=(()=>{class t{constructor(t){this.restService=t,this.apiName="SaasHost",this.create=t=>this.restService.request({method:"POST",url:"/api/saas/editions",body:t},{apiName:this.apiName}),this.delete=t=>this.restService.request({method:"DELETE",url:"/api/saas/editions/"+t},{apiName:this.apiName}),this.get=t=>this.restService.request({method:"GET",url:"/api/saas/editions/"+t},{apiName:this.apiName}),this.getList=t=>this.restService.request({method:"GET",url:"/api/saas/editions",params:{filter:t.filter,sorting:t.sorting,skipCount:t.skipCount,maxResultCount:t.maxResultCount}},{apiName:this.apiName}),this.getUsageStatistics=()=>this.restService.request({method:"GET",url:"/api/saas/editions/statistics/usage-statistic"},{apiName:this.apiName}),this.update=(t,e)=>this.restService.request({method:"PUT",url:"/api/saas/editions/"+t,body:e},{apiName:this.apiName})}}return t.\u0275fac=function(e){return new(e||t)(o.hc(i.U))},t.\u0275prov=Object(o.Qb)({factory:function(){return new t(Object(o.hc)(i.U))},token:t,providedIn:"root"}),t})(),Bt=(()=>{class t{constructor(t){this.restService=t,this.apiName="SaasHost",this.create=t=>this.restService.request({method:"POST",url:"/api/saas/tenants",body:t},{apiName:this.apiName}),this.delete=t=>this.restService.request({method:"DELETE",url:"/api/saas/tenants/"+t},{apiName:this.apiName}),this.deleteDefaultConnectionString=t=>this.restService.request({method:"DELETE",url:`/api/saas/tenants/${t}/default-connection-string`},{apiName:this.apiName}),this.get=t=>this.restService.request({method:"GET",url:"/api/saas/tenants/"+t},{apiName:this.apiName}),this.getDefaultConnectionString=t=>this.restService.request({method:"GET",url:`/api/saas/tenants/${t}/default-connection-string`,responseType:"text"},{apiName:this.apiName}),this.getList=t=>this.restService.request({method:"GET",url:"/api/saas/tenants",params:{filter:t.filter,getEditionNames:t.getEditionNames,sorting:t.sorting,skipCount:t.skipCount,maxResultCount:t.maxResultCount}},{apiName:this.apiName}),this.update=(t,e)=>this.restService.request({method:"PUT",url:"/api/saas/tenants/"+t,body:e},{apiName:this.apiName}),this.updateDefaultConnectionString=(t,e)=>this.restService.request({method:"PUT",url:`/api/saas/tenants/${t}/default-connection-string`,params:{defaultConnectionString:e}},{apiName:this.apiName})}}return t.\u0275fac=function(e){return new(e||t)(o.hc(i.U))},t.\u0275prov=Object(o.Qb)({factory:function(){return new t(Object(o.hc)(i.U))},token:t,providedIn:"root"}),t})(),Dt=(()=>{let t=class{constructor(t,e){this.tenantService=t,this.editionService=e}static getTenants({tenants:t}){return t.items||[]}static getLatestTenants({latestTenants:t}){return t}static getTenantsTotalCount({tenants:t}){return t.totalCount||0}static getEditions({editions:t}){return t.items||[]}static getEditionsTotalCount({editions:t}){return t.totalCount||0}static getUsageStatistics({usageStatistics:t}){return t}getTenants({patchState:t},{payload:e}){return this.tenantService.getList(e).pipe(Object(l.a)(e=>t({tenants:e})))}deleteTenant(t,{payload:e}){return this.tenantService.delete(e)}createTenant(t,{payload:e}){return this.tenantService.create(e)}updateTenant(t,e){var n=e.payload,{id:i}=n,s=Object(a.e)(n,["id"]);return this.tenantService.update(i,s)}getEditions({patchState:t},{payload:e}){return this.editionService.getList(e).pipe(Object(l.a)(e=>t({editions:e})))}deleteEdition(t,{payload:e}){return this.editionService.delete(e)}createEdition(t,{payload:e}){return this.editionService.create(e)}updateEdition(t,e){var n=e.payload,{id:i}=n,s=Object(a.e)(n,["id"]);return this.editionService.update(i,s)}getUsage({patchState:t}){return this.editionService.getUsageStatistics().pipe(Object(l.a)(e=>{t({usageStatistics:e.data})}))}getLatestTenants({patchState:t}){return this.tenantService.getList({getEditionNames:!0,maxResultCount:6,skipCount:0,sorting:"CreationTime desc"}).pipe(Object(l.a)(e=>{t({latestTenants:e.items})}))}};return t.\u0275fac=function(e){return new(e||t)(o.hc(Bt),o.hc(Rt))},t.\u0275prov=o.Qb({token:t,factory:function(e){return t.\u0275fac(e)}}),Object(a.b)([Object(r.a)(Ft)],t.prototype,"getTenants",null),Object(a.b)([Object(r.a)(wt)],t.prototype,"deleteTenant",null),Object(a.b)([Object(r.a)(jt)],t.prototype,"createTenant",null),Object(a.b)([Object(r.a)(Nt)],t.prototype,"updateTenant",null),Object(a.b)([Object(r.a)(Gt)],t.prototype,"getEditions",null),Object(a.b)([Object(r.a)(Zt)],t.prototype,"deleteEdition",null),Object(a.b)([Object(r.a)(kt)],t.prototype,"createEdition",null),Object(a.b)([Object(r.a)(Mt)],t.prototype,"updateEdition",null),Object(a.b)([Object(r.a)(At)],t.prototype,"getUsage",null),Object(a.b)([Object(r.a)(Ut)],t.prototype,"getLatestTenants",null),Object(a.b)([Object(r.e)()],t,"getTenants",null),Object(a.b)([Object(r.e)()],t,"getLatestTenants",null),Object(a.b)([Object(r.e)()],t,"getTenantsTotalCount",null),Object(a.b)([Object(r.e)()],t,"getEditions",null),Object(a.b)([Object(r.e)()],t,"getEditionsTotalCount",null),Object(a.b)([Object(r.e)()],t,"getUsageStatistics",null),t=Object(a.b)([Object(r.f)({name:"SaasState",defaults:{tenants:{},editions:{},latestTenants:[],usageStatistics:{}}})],t),t})();const xt="Saas.EditionsComponent";let Lt=(()=>{class t{constructor(t,e,n,a,i){this.list=t,this.confirmationService=e,this.editionService=n,this.store=a,this.injector=i,this.visibleFeatures=!1,this.modalBusy=!1,this.onVisibleFeaturesChange=t=>{this.visibleFeatures=t}}ngOnInit(){this.hookToQuery()}hookToQuery(){this.list.hookToQuery(t=>this.store.dispatch(new Gt(t))).subscribe()}createEditionForm(){const t=new c.k(this.injector,this.selected);this.editionForm=Object(c.p)(t)}onAddEdition(){this.selected={},this.createEditionForm(),this.isModalVisible=!0}onEditEdition(t){this.editionService.get(t).subscribe(t=>{this.selected=t,this.createEditionForm(),this.isModalVisible=!0})}save(){this.editionForm.valid&&(this.modalBusy=!0,this.store.dispatch(this.selected.id?new Mt(Object.assign(Object.assign(Object.assign({},this.selected),this.editionForm.value),{id:this.selected.id})):new kt(this.editionForm.value)).pipe(Object(u.a)(()=>this.modalBusy=!1)).subscribe(()=>{this.list.get(),this.isModalVisible=!1}))}delete({id:t,displayName:e}){this.confirmationService.warn("Saas::EditionDeletionConfirmationMessage","Saas::AreYouSure",{messageLocalizationParams:[e]}).subscribe(e=>{e===s.d.Status.confirm&&this.store.dispatch(new Zt(t)).subscribe(()=>this.list.get())})}openFeaturesModal(t){this.providerKey=t,setTimeout(()=>{this.visibleFeatures=!0},0)}}return t.\u0275fac=function(e){return new(e||t)(o.Ub(i.F),o.Ub(s.e),o.Ub(Rt),o.Ub(r.g),o.Ub(o.w))},t.\u0275cmp=o.Ob({type:t,selectors:[["abp-editions"]],features:[o.Fb([i.F,{provide:c.d,useValue:xt}])],decls:10,vars:20,consts:[[4,"ngIf"],[3,"visible","busy","visibleChange","disappear"],["abpHeader",""],["abpBody",""],["abpFooter",""],["providerName","E",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[1,"row","entry-row"],[1,"col-auto"],[1,"content-header-title"],[1,"col-lg-auto","pl-lg-0"],[1,"col"],[3,"record"],["id","wrapper"],[1,"card"],[1,"card-body"],[1,"row"],[1,"input-group"],["type","search",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[1,"input-group-append"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],[3,"data","recordsTotal","list"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[1,"mt-2"],[3,"selectedRecord"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"],["providerName","E",3,"visible","providerKey","visibleChange"]],template:function(t,e){1&t&&(o.Qc(0,Y,24,13,"ng-container",0),o.pc(1,"async"),o.ac(2,"abp-modal",1),o.kc("visibleChange",function(t){return e.isModalVisible=t})("disappear",function(){return e.editionForm=null}),o.Qc(3,X,3,3,"ng-template",null,2,o.Rc),o.Qc(5,J,3,2,"ng-template",null,3,o.Rc),o.Qc(7,tt,7,7,"ng-template",null,4,o.Rc),o.Zb(),o.Qc(9,et,1,2,"abp-feature-management",5)),2&t&&(o.vc("ngIf",o.qc(1,4,e.data$)),o.Gb(2),o.vc("visible",e.isModalVisible)("busy",e.modalBusy),o.Gb(7),o.vc("abpReplaceableTemplate",o.Ac(17,ot,o.Bc(11,st,o.yc(6,nt),o.zc(7,at,e.providerKey),o.zc(9,it,e.visibleFeatures)),o.zc(15,ct,e.onVisibleFeaturesChange))))},directives:[y.q,s.h,i.S,s.a,c.m,m.e,m.q,m.t,c.h,m.B,m.r,i.w,H.j,m.k,c.g,s.b,Q],pipes:[y.b,i.H],encapsulation:2}),Object(a.b)([Object(r.d)(Dt.getEditions)],t.prototype,"data$",void 0),Object(a.b)([Object(r.d)(Dt.getEditionsTotalCount)],t.prototype,"totalCount$",void 0),t})(),Vt=(()=>{class t{constructor(t,e,n,a,i,s){this.list=t,this.confirmationService=e,this.tenantService=n,this.fb=a,this.store=i,this.injector=s,this.selectedModalContent={},this.visibleFeatures=!1,this.modalBusy=!1,this.onVisibleFeaturesChange=t=>{this.visibleFeatures=t}}get useSharedDatabase(){return this.defaultConnectionStringForm.get("useSharedDatabase").value}get connectionString(){return this.defaultConnectionStringForm.get("defaultConnectionString").value}get hasSelectedTenant(){return Boolean(this.selected.id)}get isDisabledSaveButton(){return!(!this.selectedModalContent||!("saveConnStr"===this.selectedModalContent.type&&this.defaultConnectionStringForm&&this.defaultConnectionStringForm.invalid||"saveTenant"===this.selectedModalContent.type&&this.tenantForm&&this.tenantForm.invalid))}ngOnInit(){this.hookToQuery()}hookToQuery(){this.list.hookToQuery(t=>this.store.dispatch(new Ft(t))).subscribe()}createTenantForm(){this.store.select(Dt.getEditions).pipe(Object(d.a)(t=>t.length?Object(g.a)(t):this.store.dispatch(new Gt({maxResultCount:1e3})))).subscribe(()=>{const t=new c.k(this.injector,this.selected);this.tenantForm=Object(c.p)(t)})}createDefaultConnectionStringForm(){this.defaultConnectionStringForm=this.fb.group({useSharedDatabase:this._useSharedDatabase,defaultConnectionString:this.defaultConnectionString||""})}openModal(t,e,n){this.selectedModalContent={title:t,template:e,type:n},this.isModalVisible=!0}onEditConnectionString(t){this.tenantService.get(t).pipe(Object(l.a)(t=>this.selected=t),Object(d.a)(()=>this.tenantService.getDefaultConnectionString(t))).subscribe(t=>{this._useSharedDatabase=!t,this.defaultConnectionString=t||"",this.createDefaultConnectionStringForm(),this.openModal("Saas::ConnectionStrings",this.connectionStringModalTemplate,"saveConnStr")})}onAddTenant(){this.selected={},this.createTenantForm(),this.openModal("Saas::NewTenant",this.tenantModalTemplate,"saveTenant")}onEditTenant(t){this.tenantService.get(t).subscribe(t=>{this.selected=t,this.createTenantForm(),this.openModal("Saas::Edit",this.tenantModalTemplate,"saveTenant")})}save(){const{type:t}=this.selectedModalContent;t&&("saveTenant"===t?this.saveTenant():"saveConnStr"===t&&this.saveConnectionString())}saveConnectionString(){this.modalBusy||(this.modalBusy=!0,this.useSharedDatabase||!this.useSharedDatabase&&!this.connectionString?this.tenantService.deleteDefaultConnectionString(this.selected.id).pipe(Object(p.a)(1),Object(u.a)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1}):this.tenantService.updateDefaultConnectionString(this.selected.id,this.connectionString).pipe(Object(p.a)(1),Object(u.a)(()=>this.modalBusy=!1)).subscribe(()=>{this.isModalVisible=!1}))}saveTenant(){this.tenantForm.valid&&!this.modalBusy&&(this.modalBusy=!0,this.store.dispatch(this.selected.id?new Nt(Object.assign(Object.assign(Object.assign({},this.selected),this.tenantForm.value),{id:this.selected.id})):new jt(this.tenantForm.value)).pipe(Object(u.a)(()=>this.modalBusy=!1)).subscribe(()=>{this.list.get(),this.isModalVisible=!1}))}delete(t,e){this.confirmationService.warn("Saas::TenantDeletionConfirmationMessage","Saas::AreYouSure",{messageLocalizationParams:[e]}).subscribe(e=>{e===s.d.Status.confirm&&this.store.dispatch(new wt(t)).subscribe(()=>this.list.get())})}onSharedDatabaseChange(t){t||setTimeout(()=>{const t=document.getElementById("defaultConnectionString");t&&t.focus()},0)}openFeaturesModal(t){this.providerKey=t,setTimeout(()=>{this.visibleFeatures=!0},0)}}return t.\u0275fac=function(e){return new(e||t)(o.Ub(i.F),o.Ub(s.e),o.Ub(Bt),o.Ub(m.f),o.Ub(r.g),o.Ub(o.w))},t.\u0275cmp=o.Ob({type:t,selectors:[["abp-tenants"]],viewQuery:function(t,e){if(1&t&&(o.Wc(rt,1),o.Wc(lt,1)),2&t){let t;o.Ec(t=o.lc())&&(e.tenantModalTemplate=t.first),o.Ec(t=o.lc())&&(e.connectionStringModalTemplate=t.first)}},features:[o.Fb([i.F,{provide:c.d,useValue:"Saas.TenantsComponent"}])],decls:14,vars:20,consts:[[4,"ngIf"],[3,"visible","busy","visibleChange","disappear"],["abpHeader",""],["abpBody",""],["abpFooter",""],["tenantModalTemplate",""],["connectionStringModalTemplate",""],["providerName","T",3,"visible","providerKey","visibleChange",4,"abpReplaceableTemplate"],[1,"row","entry-row"],[1,"col-auto"],[1,"content-header-title"],[1,"col-lg-auto","pl-lg-0"],[1,"col"],[3,"record"],["id","wrapper"],[1,"card"],[1,"card-body"],[1,"row"],[1,"input-group"],["type","search",1,"form-control",3,"placeholder","ngModel","ngModelChange"],[1,"input-group-append"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-search"],[3,"data","recordsTotal","list"],[4,"ngTemplateOutlet"],["type","button",1,"btn","btn-secondary"],["abpClose",""],["iconClass","fa fa-check",3,"disabled","click"],["validateOnSubmit","",3,"formGroup","ngSubmit",4,"ngIf"],["validateOnSubmit","",3,"formGroup","ngSubmit"],[1,"mt-2"],[3,"selectedRecord"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"custom-checkbox","custom-control","mb-2"],["id","useSharedDatabase","type","checkbox","formControlName","useSharedDatabase","autofocus","",1,"custom-control-input",3,"ngModelChange"],["for","useSharedDatabase",1,"custom-control-label"],["class","form-group",4,"ngIf"],["for","defaultConnectionString"],["type","text","id","defaultConnectionString","formControlName","defaultConnectionString",1,"form-control"],["providerName","T",3,"visible","providerKey","visibleChange"]],template:function(t,e){1&t&&(o.Qc(0,ut,24,13,"ng-container",0),o.pc(1,"async"),o.ac(2,"abp-modal",1),o.kc("visibleChange",function(t){return e.isModalVisible=t})("disappear",function(){return e.tenantForm=null,e.defaultConnectionStringForm=null}),o.Qc(3,dt,3,3,"ng-template",null,2,o.Rc),o.Qc(5,bt,1,1,"ng-template",null,3,o.Rc),o.Qc(7,ht,7,7,"ng-template",null,4,o.Rc),o.Zb(),o.Qc(9,gt,1,1,"ng-template",null,5,o.Rc),o.Qc(11,vt,9,5,"ng-template",null,6,o.Rc),o.Qc(13,St,1,2,"abp-feature-management",7)),2&t&&(o.vc("ngIf",o.qc(1,4,e.tenants$)),o.Gb(2),o.vc("visible",e.isModalVisible)("busy",e.modalBusy),o.Gb(11),o.vc("abpReplaceableTemplate",o.Ac(17,ot,o.Bc(11,st,o.yc(6,yt),o.zc(7,at,e.providerKey),o.zc(9,it,e.visibleFeatures)),o.zc(15,ct,e.onVisibleFeaturesChange))))},directives:[y.q,s.h,i.S,s.a,c.m,m.e,m.q,m.t,c.h,y.v,s.b,m.B,m.r,i.w,H.j,m.k,c.g,m.c,H.h,m.i,i.i,Q],pipes:[y.b,i.H],encapsulation:2}),Object(a.b)([Object(r.d)(Dt.getTenants)],t.prototype,"tenants$",void 0),Object(a.b)([Object(r.d)(Dt.getTenantsTotalCount)],t.prototype,"totalCount$",void 0),Object(a.b)([Object(r.d)(Dt.getEditions)],t.prototype,"editions$",void 0),t})(),qt=(()=>{class t{constructor(t,e,n){this.store=t,this.subscription=e,this.permissionService=n,this.initialized=new f.a(this),this.width=273,this.height=136,this.chartData={},this.draw=()=>{this.permissionService.getGrantedPolicy("Saas.Editions")&&this.store.dispatch(new At)},this.listenToData()}initialize(t){this.chart=t}listenToData(){this.subscription.addOne(this.data$,t=>{if(!t||"{}"===JSON.stringify(t))return void(this.chartData={});const e=Object.keys(t);setTimeout(()=>{this.chartData={labels:e,datasets:[{data:e.map(e=>t[e]),backgroundColor:Object(s.s)(Object.keys(t).length)}]},this.chart.refresh()},0)})}}return t.\u0275fac=function(e){return new(e||t)(o.Ub(r.g),o.Ub(i.db),o.Ub(i.O))},t.\u0275cmp=o.Ob({type:t,selectors:[["abp-editions-usage-widget"]],inputs:{width:"width",height:"height"},outputs:{initialized:"initialized"},features:[o.Fb([i.db])],decls:1,vars:1,consts:[["class","abp-widget-wrapper",4,"abpPermission"],[1,"abp-widget-wrapper"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"row"],["type","pie",1,"w-100",3,"data","width","height","initialized"],["chart",""]],template:function(t,e){1&t&&o.Qc(0,Tt,10,6,"div",0),2&t&&o.vc("abpPermission","Saas.Editions")},directives:[i.M,s.c],pipes:[i.H],encapsulation:2}),Object(a.b)([Object(r.d)(Dt.getUsageStatistics)],t.prototype,"data$",void 0),t})(),_t=(()=>{class t{constructor(t,e){this.store=t,this.permissionService=e,this.minHeight=136,this.trackByFn=(t,e)=>e.id,this.draw=()=>{this.permissionService.getGrantedPolicy("Saas.Tenants")&&this.store.dispatch(new Ut)}}}return t.\u0275fac=function(e){return new(e||t)(o.Ub(r.g),o.Ub(i.O))},t.\u0275cmp=o.Ob({type:t,selectors:[["abp-latest-tenants-widget"]],inputs:{minHeight:"minHeight"},decls:1,vars:1,consts:[["class","abp-widget-wrapper","data-widget-name","SaasLatestTenantsWidget","data-refresh-url","SaasWidgets/LatestTenants",4,"abpPermission"],["data-widget-name","SaasLatestTenantsWidget","data-refresh-url","SaasWidgets/LatestTenants",1,"abp-widget-wrapper"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-body"],[1,"table","table-hover","table-sm"],[4,"ngFor","ngForOf","ngForTrackBy"]],template:function(t,e){1&t&&o.Qc(0,Ot,21,12,"div",0),2&t&&o.vc("abpPermission","Saas.Tenants")},directives:[i.M,y.p],pipes:[i.H,y.b],encapsulation:2}),Object(a.b)([Object(r.d)(Dt.getLatestTenants)],t.prototype,"datas$",void 0),t})();const Qt=c.e.createMany([{text:"Saas::Edit",action:t=>{t.getInjected(Lt).onEditEdition(t.record.id)},permission:"Saas.Editions.Update"},{text:"Saas::Features",action:t=>{t.getInjected(Lt).openFeaturesModal(t.record.id)},permission:"Saas.Editions.ManageFeatures"},{text:"Saas::ChangeHistory",action:t=>{t.getInjected(v.c)(t.record.id,"Volo.Saas.Edition")},permission:"Saas.Editions.ViewChangeHistory",visible:t=>Boolean(t.getInjected(v.c,null))},{text:"Saas::Delete",action:t=>{t.getInjected(Lt).delete(t.record)},permission:"Saas.Editions.Delete"}]),Pt=c.f.createMany([{type:"string",name:"displayName",displayName:"Saas::EditionName",sortable:!0}]),zt=c.j.createMany([{type:"string",name:"displayName",displayName:"Saas::EditionName",validators:()=>[m.A.required,m.A.maxLength(256)]}]),$t=zt,Kt=c.n.createMany([{text:"Saas::NewEdition",action:t=>{t.getInjected(Lt).onAddEdition()},permission:"Saas.Editions.Create",icon:"fa fa-plus"}]),Ht=c.e.createMany([{text:"Saas::Edit",action:t=>{t.getInjected(Vt).onEditTenant(t.record.id)},permission:"Saas.Tenants.Update"},{text:"Saas::ConnectionStrings",action:t=>{t.getInjected(Vt).onEditConnectionString(t.record.id)},permission:"Saas.Tenants.ManageConnectionStrings"},{text:"Saas::Features",action:t=>{t.getInjected(Vt).openFeaturesModal(t.record.id)},permission:"Saas.Tenants.ManageFeatures"},{text:"Saas::ChangeHistory",action:t=>{t.getInjected(v.c)(t.record.id,"Volo.Saas.Tenant")},permission:"Saas.Tenants.ViewChangeHistory",visible:t=>Boolean(t.getInjected(v.c,null))},{text:"Saas::Delete",action:t=>{t.getInjected(Vt).delete(t.record.id,t.record.name)},permission:"Saas.Tenants.Delete"}]),Wt=c.f.createMany([{type:"string",name:"name",displayName:"Saas::TenantName",sortable:!0,columnWidth:370},{type:"string",name:"editionName",displayName:"Saas::EditionName",columnWidth:370}]),Yt=c.j.createMany([{type:"string",name:"name",id:"name",displayName:"Saas::TenantName",validators:()=>[m.A.required,m.A.maxLength(256)]},{type:"string",name:"editionId",displayName:"Saas::Edition",id:"edition",options:t=>t.getInjected(Vt).editions$.pipe(Object(b.a)(t=>[{key:"",value:""},...t.map(t=>({key:t.displayName,value:t.id}))]))},{type:"email",name:"adminEmailAddress",displayName:"Saas::DisplayName:AdminEmailAddress",id:"admin-email-address",validators:()=>[m.A.required,m.A.maxLength(256),m.A.email]},{type:"password",name:"adminPassword",displayName:"Saas::DisplayName:AdminPassword",id:"admin-password",autocomplete:"new-password",validators:t=>[m.A.required,...Object(s.r)({get:t.getInjected})]}]),Xt=Yt.slice(0,2),Jt=c.n.createMany([{text:"Saas::ManageHostFeatures",action:t=>{t.getInjected(Vt).openFeaturesModal(null)},permission:"Saas.Tenants.ManageFeatures",icon:"fa fa-cog"},{text:"Saas::NewTenant",action:t=>{t.getInjected(Vt).onAddTenant()},permission:"Saas.Tenants.Create",icon:"fa fa-plus"}]),te={"Saas.EditionsComponent":Qt,"Saas.TenantsComponent":Ht},ee={"Saas.EditionsComponent":Kt,"Saas.TenantsComponent":Jt},ne={"Saas.EditionsComponent":Pt,"Saas.TenantsComponent":Wt},ae={"Saas.EditionsComponent":zt,"Saas.TenantsComponent":Yt},ie={"Saas.EditionsComponent":$t,"Saas.TenantsComponent":Xt},se=new o.v("SAAS_ENTITY_ACTION_CONTRIBUTORS"),ce=new o.v("SAAS_TOOLBAR_ACTION_CONTRIBUTORS"),oe=new o.v("SAAS_ENTITY_PROP_CONTRIBUTORS"),re=new o.v("SAAS_CREATE_FORM_PROP_CONTRIBUTORS"),le=new o.v("SAAS_EDIT_FORM_PROP_CONTRIBUTORS");let ue=(()=>{class t{constructor(t){this.injector=t}canActivate(){const t=this.injector.get(c.i),e=this.injector.get(se,null)||{},n=this.injector.get(ce,null)||{},a=this.injector.get(oe,null)||{},s=this.injector.get(re,null)||{},o=this.injector.get(le,null)||{},r=this.injector.get(i.m);return Object(c.q)(r,"Saas").pipe(Object(b.a)(t=>({"Saas.EditionsComponent":t.Edition,"Saas.TenantsComponent":t.Tenant})),Object(c.r)(r,"Saas"),Object(l.a)(i=>{Object(c.s)(t.entityActions,te,e),Object(c.s)(t.toolbarActions,ee,n),Object(c.t)(t.entityProps,ne,i.prop,a),Object(c.t)(t.createFormProps,ae,i.createForm,s),Object(c.t)(t.editFormProps,ie,i.editForm,o)}),Object(h.a)(!0))}}return t.\u0275fac=function(e){return new(e||t)(o.hc(o.w))},t.\u0275prov=o.Qb({token:t,factory:t.\u0275fac}),t})();const de=[{path:"",redirectTo:"tenants",pathMatch:"full"},{path:"",component:i.r,canActivate:[i.g,i.N,ue],children:[{path:"tenants",component:i.R,data:{requiredPolicy:"Saas.Tenants",replaceableComponent:{key:"Saas.TenantsComponent",defaultComponent:Vt}}},{path:"editions",component:i.R,data:{requiredPolicy:"Saas.Editions",replaceableComponent:{key:"Saas.EditionsComponent",defaultComponent:Lt}}}]}];let pe=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.Sb({type:t}),t.\u0275inj=o.Rb({imports:[[W.n.forChild(de)],W.n]}),t})(),be=(()=>{class t{static forChild(e={}){return{ngModule:t,providers:[{provide:se,useValue:e.entityActionContributors},{provide:ce,useValue:e.toolbarActionContributors},{provide:oe,useValue:e.entityPropContributors},{provide:re,useValue:e.createFormPropContributors},{provide:le,useValue:e.editFormPropContributors},ue]}}static forLazy(e={}){return new i.E(t.forChild(e))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.Sb({type:t}),t.\u0275inj=o.Rb({imports:[[pe,r.c.forFeature([Dt]),H.a,i.o,v.a,s.n,S.h,K]]}),t})(),he=(()=>{class t{constructor(t){this.store=t}getTenants(){return this.store.selectSnapshot(Dt.getTenants)}getLatestTenants(){return this.store.selectSnapshot(Dt.getLatestTenants)}getTenantsTotalCount(){return this.store.selectSnapshot(Dt.getTenantsTotalCount)}getEditions(){return this.store.selectSnapshot(Dt.getEditions)}getEditionsTotalCount(){return this.store.selectSnapshot(Dt.getEditionsTotalCount)}getUsageStatistics(){return this.store.selectSnapshot(Dt.getUsageStatistics)}dispatchGetTenants(...t){return this.store.dispatch(new Ft(...t))}dispatchGetTenantById(...t){return this.store.dispatch(new Et(...t))}dispatchCreateTenant(...t){return this.store.dispatch(new jt(...t))}dispatchUpdateTenant(...t){return this.store.dispatch(new Nt(...t))}dispatchDeleteTenant(...t){return this.store.dispatch(new wt(...t))}dispatchGetEditions(...t){return this.store.dispatch(new Gt(...t))}dispatchGetEditionById(...t){return this.store.dispatch(new It(...t))}dispatchCreateEdition(...t){return this.store.dispatch(new kt(...t))}dispatchUpdateEdition(...t){return this.store.dispatch(new Mt(...t))}dispatchDeleteEdition(...t){return this.store.dispatch(new Zt(...t))}dispatchGetUsageStatistics(){return this.store.dispatch(new At)}dispatchGetLatestTenants(){return this.store.dispatch(new Ut)}}return t.\u0275fac=function(e){return new(e||t)(o.hc(r.g))},t.\u0275prov=Object(o.Qb)({factory:function(){return new t(Object(o.hc)(r.g))},token:t,providedIn:"root"}),t})()}}]);